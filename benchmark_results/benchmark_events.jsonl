{"ts": 1757351622.7031019, "label": "full_benchmark_profile", "block": "optimizations.functions", "duration_ms": 78284.255, "cpu_profile": "benchmark_results/optimizations.functions.prof", "mem_top": "yield pa.table(base_data) - size=11.7 KiB, count=231\ncallers[func] = nc, cc, tt, ct - size=9.5 KiB, count=88\nentries = self.getstats() - size=4.6 KiB, count=189\nself.stats[func] = cc, nc, tt, ct, callers - size=4.0 KiB, count=38\nreturn (code.co_filename, code.co_firstlineno, code.co_name) - size=2.9 KiB, count=58"}
{"ts": 1757351623.290334, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 0.414, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.9 KiB, count=4\nself.traces = _Traces(traces) - size=0.9 KiB, count=4\ntraces = _get_traces() - size=6.4 KiB, count=107\ndef __exit__(self, typ, value, traceback): - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2"}
{"ts": 1757351623.35326, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 48.0, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=13.2 KiB, count=252\nself._frames = tuple(reversed(frames)) - size=6.3 KiB, count=135\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351623.vortex"}
{"ts": 1757351623.353766, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0745}
{"ts": 1757351623.365721, "label": "full_benchmark_profile", "block": "optimizations.impact.write_baseline", "duration_ms": 75.406, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=218.1 KiB, count=2274\nself._frames = tuple(reversed(frames)) - size=18.3 KiB, count=390\ntraces = _get_traces() - size=17.7 KiB, count=348\nreturn (abs(self.size_diff), self.size, - size=15.4 KiB, count=198\nself.stats[func] = cc, nc, tt, ct, callers - size=0.0 KiB, count=0", "rows": 100000}
{"ts": 1757351623.384867, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 0.748, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3\nself.traces = _Traces(traces) - size=0.8 KiB, count=3\ntraces = _get_traces() - size=21.1 KiB, count=420\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nprof.enable() - size=4.1 KiB, count=60"}
{"ts": 1757351623.447587, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 45.629, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=37.2 KiB, count=763\nself._frames = tuple(reversed(frames)) - size=9.6 KiB, count=204\nself.traces = _Traces(traces) - size=0.8 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3\nvx.io.write(reader, file_path) - size=0.7 KiB, count=12", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351623.vortex"}
{"ts": 1757351623.448103, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0794}
{"ts": 1757351623.464434, "label": "full_benchmark_profile", "block": "optimizations.impact.write_optimized", "duration_ms": 82.103, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=36.0 KiB, count=738\nlines = fp.readlines() - size=246.2 KiB, count=2593\nself._frames = tuple(reversed(frames)) - size=10.6 KiB, count=227\nreturn (abs(self.size_diff), self.size, - size=16.3 KiB, count=210\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757351626.373805, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 0.806, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.7 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3\ntraces = _get_traces() - size=27.5 KiB, count=556\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\nSequence.__init__(self) - size=0.0 KiB, count=1"}
{"ts": 1757351626.581144, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 189.539, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=37.9 KiB, count=777\nself._frames = tuple(reversed(frames)) - size=9.5 KiB, count=202\nvx.io.write(reader, file_path) - size=0.9 KiB, count=16\nself.traces = _Traces(traces) - size=0.7 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351626.vortex"}
{"ts": 1757351626.5816581, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2252}
{"ts": 1757351626.598196, "label": "full_benchmark_profile", "block": "optimizations.impact.write_baseline", "duration_ms": 226.496, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=31.7 KiB, count=645\nself._frames = tuple(reversed(frames)) - size=15.5 KiB, count=331\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=9\nvx.io.write(reader, file_path) - size=0.9 KiB, count=16\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2", "rows": 500000}
{"ts": 1757351626.6328168, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 17.392, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=0.0 KiB, count=0\nreturn (abs(self.size_diff), self.size, - size=0.3 KiB, count=4\ntraces = _get_traces() - size=24.3 KiB, count=488\nreturn (code.co_filename, code.co_firstlineno, code.co_name) - size=0.0 KiB, count=0\nentries = self.getstats() - size=0.0 KiB, count=0"}
{"ts": 1757351626.840278, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 190.612, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=34.6 KiB, count=707\nself._frames = tuple(reversed(frames)) - size=9.0 KiB, count=192\nvx.io.write(reader, file_path) - size=1.1 KiB, count=20\nreturn Snapshot(traces, traceback_limit) - size=0.6 KiB, count=3\nself.traces = _Traces(traces) - size=0.6 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351626.vortex"}
{"ts": 1757351626.840884, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2411}
{"ts": 1757351626.857213, "label": "full_benchmark_profile", "block": "optimizations.impact.write_optimized", "duration_ms": 242.11, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=16.0 KiB, count=341\ntraces = _get_traces() - size=28.5 KiB, count=577\nreturn (code.co_filename, code.co_firstlineno, code.co_name) - size=0.0 KiB, count=0\nentries = self.getstats() - size=0.0 KiB, count=0\nreturn ('~', 0, code)    # built-in functions ('~' sorts at the end) - size=0.0 KiB, count=0", "rows": 500000}
{"ts": 1757351635.5022101, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 0.795, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=25.6 KiB, count=516\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nreturn pa.table(base_data) - size=1.0 KiB, count=20"}
{"ts": 1757351636.0766442, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 557.681, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.0 KiB, count=716\nself._frames = tuple(reversed(frames)) - size=9.6 KiB, count=205\nvx.io.write(reader, file_path) - size=1.3 KiB, count=24\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351635.vortex"}
{"ts": 1757351636.07717, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 22101940, "seconds": 0.5919}
{"ts": 1757351636.093602, "label": "full_benchmark_profile", "block": "optimizations.impact.write_baseline", "duration_ms": 593.041, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=30.8 KiB, count=626\nself._frames = tuple(reversed(frames)) - size=13.7 KiB, count=292\nreturn pa.table(base_data) - size=0.9 KiB, count=17\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.7 KiB, count=11\nvx.io.write(reader, file_path) - size=1.3 KiB, count=24", "rows": 1500000}
{"ts": 1757351636.114877, "label": "full_benchmark_profile", "block": "vortex.write.batch_size_calc", "duration_ms": 0.998, "cpu_profile": null, "mem_top": "def _calculate_optimal_vortex_batch_size(table: pa.Table) -> int: - size=0.2 KiB, count=3\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.batch_size_calc\", {\"rows\": num_rows}): - size=0.2 KiB, count=4\n_repr=float.__repr__, _inf=INFINITY, _neginf=-INFINITY): - size=0.0 KiB, count=1", "rows": 1500000}
{"ts": 1757351636.1412401, "label": "full_benchmark_profile", "block": "vortex.write.to_batches", "duration_ms": 1.344, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.0 KiB, count=716\nself._frames = tuple(reversed(frames)) - size=9.6 KiB, count=204\nbatches = table.to_batches(max_chunksize=optimal_batch_size) - size=0.3 KiB, count=5\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3", "target_batch": 400000}
{"ts": 1757351636.169278, "label": "full_benchmark_profile", "block": "vortex.write.layout_optimize", "duration_ms": 1.253, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.3 KiB, count=721\nself._frames = tuple(reversed(frames)) - size=9.5 KiB, count=203\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=9\ndef _optimize_vortex_batch_layout(batches: List[pa.RecordBatch], target_batch_size: int) -> List[pa.RecordBatch]: - size=0.2 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=4", "batches": 4}
{"ts": 1757351636.1969202, "label": "full_benchmark_profile", "block": "vortex.write.reader_from_batches", "duration_ms": 1.399, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.4 KiB, count=723\nself._frames = tuple(reversed(frames)) - size=9.4 KiB, count=200\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nreader = pa.RecordBatchReader.from_batches(table.schema, optimized_batches) - size=0.1 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=3"}
{"ts": 1757351636.8061938, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 582.69, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.8 KiB, count=731\nself._frames = tuple(reversed(frames)) - size=9.4 KiB, count=201\nvx.io.write(reader, file_path) - size=1.6 KiB, count=28\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nprof.enable() - size=5.0 KiB, count=77", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351636.vortex"}
{"ts": 1757351636.806874, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 22101940, "seconds": 0.712}
{"ts": 1757351636.8282518, "label": "full_benchmark_profile", "block": "optimizations.impact.write_optimized", "duration_ms": 712.988, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=558.4 KiB, count=5787\ntraces = _get_traces() - size=31.5 KiB, count=641\nself._frames = tuple(reversed(frames)) - size=13.7 KiB, count=293\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=9\nprof = cProfile.Profile() - size=1.8 KiB, count=36", "rows": 1500000}
{"ts": 1757351636.8457081, "label": "full_benchmark_profile", "block": "optimizations.impact", "duration_ms": 14126.731, "cpu_profile": "benchmark_results/optimizations.impact.prof", "mem_top": "lines = fp.readlines() - size=558.4 KiB, count=5787\ntraces = _get_traces() - size=25.5 KiB, count=513\nself._frames = tuple(reversed(frames)) - size=19.6 KiB, count=419\nentries = self.getstats() - size=17.2 KiB, count=647\ncallers[func] = nc, cc, tt, ct - size=18.4 KiB, count=116"}
{"ts": 1757351637.455887, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 581.413, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.7 KiB, count=10\n'id': np.arange(num_rows, dtype=np.int64), - size=781.7 KiB, count=8\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757351637.487294, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 1.399, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\ntraces = _get_traces() - size=27.0 KiB, count=544"}
{"ts": 1757351637.5641978, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 49.287, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=37.7 KiB, count=770\nself._frames = tuple(reversed(frames)) - size=8.8 KiB, count=188\nvx.io.write(reader, file_path) - size=1.7 KiB, count=31\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351637.vortex"}
{"ts": 1757351637.564917, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.1056}
{"ts": 1757351637.592396, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 108.329, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=32.6 KiB, count=662\nself._frames = tuple(reversed(frames)) - size=13.9 KiB, count=296\nvx.io.write(reader, file_path) - size=1.7 KiB, count=31\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.7 KiB, count=12\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=6", "rows": 100000}
{"ts": 1757351637.648577, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 21.557, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.7 KiB, count=8\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351637.parquet"}
{"ts": 1757351637.685407, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 57.169, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1016.0 KiB, count=10773\ntraces = _get_traces() - size=36.3 KiB, count=742\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\nentries = self.getstats() - size=4.7 KiB, count=133\ndef _stringify_path(path): - size=0.3 KiB, count=4", "rows": 100000}
{"ts": 1757351637.784508, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 3.771, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.4 KiB, count=6\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351637.833762, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 3.475, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=49.1 KiB, count=1014\nself._frames = tuple(reversed(frames)) - size=10.7 KiB, count=229\narray = self.to_arrow_array() - size=1.6 KiB, count=30\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757351637.834721, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0959}
{"ts": 1757351637.879545, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 98.482, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1044.5 KiB, count=11103\ntraces = _get_traces() - size=43.7 KiB, count=899\nself._frames = tuple(reversed(frames)) - size=16.4 KiB, count=350\narray = self.to_arrow_array() - size=1.5 KiB, count=28\nyield pa.table(base_data) - size=8.5 KiB, count=168", "rows": 100000}
{"ts": 1757351637.9554749, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 5.556, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.6 KiB, count=8\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=4\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=4", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351638.0024729, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 53.96, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1076.9 KiB, count=11464\ntraces = _get_traces() - size=45.5 KiB, count=937\nself._frames = tuple(reversed(frames)) - size=20.8 KiB, count=443\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndef __getattr__(name): - size=0.3 KiB, count=5", "rows": 100000}
{"ts": 1757351638.004447, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.5265, "read_ratio": 0.5363, "size_ratio": 1.9323}
{"ts": 1757351640.9086342, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 2858.492, "cpu_profile": null, "mem_top": "'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.7 KiB, count=10\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.7 KiB, count=8\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757351640.961335, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 2.295, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\ntraces = _get_traces() - size=48.2 KiB, count=993\nsuper().__init__(*args) - size=0.1 KiB, count=1"}
{"ts": 1757351641.19965, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 191.634, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=59.6 KiB, count=1237\nself._frames = tuple(reversed(frames)) - size=13.1 KiB, count=279\nvx.io.write(reader, file_path) - size=1.9 KiB, count=34\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nprof.enable() - size=6.2 KiB, count=101", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351640.vortex"}
{"ts": 1757351641.200762, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2875}
{"ts": 1757351641.246142, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 290.697, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=49.2 KiB, count=1015\nself._frames = tuple(reversed(frames)) - size=23.4 KiB, count=499\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.9 KiB, count=14\nvx.io.write(reader, file_path) - size=1.9 KiB, count=34\nwith self.instr.profile_block(\"vortex.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757351641.3649511, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 70.034, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nprof.enable() - size=6.3 KiB, count=104\ntraces = _get_traces() - size=50.2 KiB, count=1037\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351641.parquet"}
{"ts": 1757351641.415137, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 119.893, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=49.3 KiB, count=1018\nself._frames = tuple(reversed(frames)) - size=23.1 KiB, count=492\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=2.5 KiB, count=39\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.5 KiB, count=12", "rows": 500000}
{"ts": 1757351641.661348, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 4.744, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=49.0 KiB, count=1012\nprof.enable() - size=6.3 KiB, count=104", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351641.717851, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 8.991, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=13.4 KiB, count=286\ntraces = _get_traces() - size=59.0 KiB, count=1224\narray = self.to_arrow_array() - size=3.0 KiB, count=62\nyield pa.table(base_data) - size=7.7 KiB, count=152\nprof = cProfile.Profile() - size=2.6 KiB, count=52"}
{"ts": 1757351641.718827, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.1102}
{"ts": 1757351641.765654, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 113.198, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=51.3 KiB, count=1061\nself._frames = tuple(reversed(frames)) - size=21.0 KiB, count=448\narray = self.to_arrow_array() - size=2.9 KiB, count=59\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.9 KiB, count=15\nyield pa.table(base_data) - size=7.7 KiB, count=152", "rows": 500000}
{"ts": 1757351641.898895, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 10.975, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.6 KiB, count=8\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.8 KiB, count=8\ntraces = _get_traces() - size=48.9 KiB, count=1008\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3\nmarkers = {} - size=0.1 KiB, count=1", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351641.947962, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 64.953, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=50.3 KiB, count=1038\nself._frames = tuple(reversed(frames)) - size=22.3 KiB, count=476\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.8 KiB, count=8\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=2.8 KiB, count=44\nwith self.instr.profile_block(\"parquet.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757351641.949261, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4061, "read_ratio": 0.5659, "size_ratio": 1.7877}
{"ts": 1757351650.6037672, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 8608.989, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=11719.2 KiB, count=11\n'id': np.arange(num_rows, dtype=np.int64), - size=11719.2 KiB, count=8\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=11719.1 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=11718.8 KiB, count=2\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=11718.9 KiB, count=3", "rows": 1500000, "complexity": "medium"}
{"ts": 1757351650.656853, "label": "full_benchmark_profile", "block": "vortex.write.batch_size_calc", "duration_ms": 2.865, "cpu_profile": null, "mem_top": "def _calculate_optimal_vortex_batch_size(table: pa.Table) -> int: - size=0.2 KiB, count=3\ntraces = _get_traces() - size=51.5 KiB, count=1065\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.batch_size_calc\", {\"rows\": num_rows}): - size=0.2 KiB, count=4", "rows": 1500000}
{"ts": 1757351650.707338, "label": "full_benchmark_profile", "block": "vortex.write.to_batches", "duration_ms": 3.148, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=13.2 KiB, count=282\ntraces = _get_traces() - size=59.4 KiB, count=1232\nbatches = table.to_batches(max_chunksize=optimal_batch_size) - size=0.3 KiB, count=5\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=4\nself.traces = _Traces(traces) - size=0.3 KiB, count=4", "target_batch": 400000}
{"ts": 1757351650.7569191, "label": "full_benchmark_profile", "block": "vortex.write.layout_optimize", "duration_ms": 2.807, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=59.4 KiB, count=1231\nself._frames = tuple(reversed(frames)) - size=13.2 KiB, count=282\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=10\ndef _optimize_vortex_batch_layout(batches: List[pa.RecordBatch], target_batch_size: int) -> List[pa.RecordBatch]: - size=0.2 KiB, count=3\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "batches": 4}
{"ts": 1757351650.807538, "label": "full_benchmark_profile", "block": "vortex.write.reader_from_batches", "duration_ms": 2.893, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=60.0 KiB, count=1245\nself._frames = tuple(reversed(frames)) - size=12.8 KiB, count=274\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nreader = pa.RecordBatchReader.from_batches(table.schema, optimized_batches) - size=0.1 KiB, count=2\nself.traces = _Traces(traces) - size=0.2 KiB, count=3"}
{"ts": 1757351651.4345899, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 581.087, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=59.9 KiB, count=1243\nself._frames = tuple(reversed(frames)) - size=12.8 KiB, count=272\nvx.io.write(reader, file_path) - size=2.0 KiB, count=36\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351650.vortex"}
{"ts": 1757351651.435593, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 22101940, "seconds": 0.8277}
{"ts": 1757351651.481247, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 830.269, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=51.3 KiB, count=1059\nself._frames = tuple(reversed(frames)) - size=21.6 KiB, count=460\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=10\nprof.enable() - size=6.6 KiB, count=115\nprof = cProfile.Profile() - size=3.0 KiB, count=61", "rows": 1500000}
{"ts": 1757351651.719212, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 187.064, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nprof = cProfile.Profile() - size=3.1 KiB, count=62\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351651.parquet"}
{"ts": 1757351651.7670631, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 237.89, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=50.9 KiB, count=1051\nself._frames = tuple(reversed(frames)) - size=22.0 KiB, count=470\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=3.2 KiB, count=51\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.5 KiB, count=14", "rows": 1500000}
{"ts": 1757351652.382675, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 7.991, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=51.6 KiB, count=1065\nvortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351652.4556448, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 23.92, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=61.0 KiB, count=1266\nself._frames = tuple(reversed(frames)) - size=12.5 KiB, count=266\narray = self.to_arrow_array() - size=4.9 KiB, count=102\nyield pa.table(base_data) - size=6.8 KiB, count=135\nwith self.instr.profile_block(\"vortex.read.to_arrow_table\"): - size=0.1 KiB, count=1"}
{"ts": 1757351652.456564, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 1500000, "seconds": 0.1305}
{"ts": 1757351652.503847, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 134.246, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=51.4 KiB, count=1061\nself._frames = tuple(reversed(frames)) - size=22.0 KiB, count=470\narray = self.to_arrow_array() - size=4.8 KiB, count=100\nyield pa.table(base_data) - size=6.8 KiB, count=135\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.0 KiB, count=17", "rows": 1500000}
{"ts": 1757351652.761329, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 22.6, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.6 KiB, count=8\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.2 KiB, count=11\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3\nmarkers = {} - size=0.1 KiB, count=1\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351652.810239, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 72.163, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=51.1 KiB, count=1055\nself._frames = tuple(reversed(frames)) - size=22.3 KiB, count=476\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.2 KiB, count=11\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=3.6 KiB, count=57\nwith self.instr.profile_block(\"parquet.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 1500000}
{"ts": 1757351652.8114119, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 1500000, "write_ratio": 0.2837, "read_ratio": 0.5331, "size_ratio": 1.581}
{"ts": 1757351690.5312371, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 37672.728, "cpu_profile": null, "mem_top": "'price': (np.arange(start_idx, start_idx + current_chunk_size) % 1000).astype(np.float64) + 0.99, - size=39068.0 KiB, count=151\n'timestamp': np.arange(1000000 + start_idx, 1000000 + start_idx + current_chunk_size, dtype=np.int64), - size=39068.0 KiB, count=149\n'id': np.arange(start_idx, start_idx + current_chunk_size, dtype=np.int64), - size=39067.2 KiB, count=101\n'value': np.arange(start_idx, start_idx + current_chunk_size, dtype=np.float64) * 1.5, - size=39067.2 KiB, count=100\n'score': np.arange(start_idx, start_idx + current_chunk_size, dtype=np.float64) * 0.1, - size=39067.2 KiB, count=100", "rows": 5000000, "complexity": "medium"}
{"ts": 1757351690.5868769, "label": "full_benchmark_profile", "block": "vortex.write.batch_size_calc", "duration_ms": 2.538, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\ntraces = _get_traces() - size=51.6 KiB, count=1066\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.batch_size_calc\", {\"rows\": num_rows}): - size=0.2 KiB, count=4\nSequence.__init__(self) - size=0.0 KiB, count=1", "rows": 5000000}
{"ts": 1757351690.639192, "label": "full_benchmark_profile", "block": "vortex.write.to_batches", "duration_ms": 2.611, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.1 KiB, count=1288\nself._frames = tuple(reversed(frames)) - size=12.8 KiB, count=274\nbatches = table.to_batches(max_chunksize=optimal_batch_size) - size=4.4 KiB, count=52\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "target_batch": 500000}
{"ts": 1757351690.6917179, "label": "full_benchmark_profile", "block": "vortex.write.layout_optimize", "duration_ms": 2.646, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.2 KiB, count=1291\nself._frames = tuple(reversed(frames)) - size=12.9 KiB, count=276\noptimized_batches = combined_table.to_batches(max_chunksize=target_batch_size) - size=3.9 KiB, count=50\nreturn list(optimized_batches) - size=0.4 KiB, count=2\nself.traces = _Traces(traces) - size=0.3 KiB, count=4", "batches": 50}
{"ts": 1757351690.744447, "label": "full_benchmark_profile", "block": "vortex.write.reader_from_batches", "duration_ms": 2.574, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=12.9 KiB, count=276\ntraces = _get_traces() - size=62.2 KiB, count=1290\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=4\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreader = pa.RecordBatchReader.from_batches(table.schema, optimized_batches) - size=0.1 KiB, count=2"}
{"ts": 1757351692.6912792, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 1896.066, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.3 KiB, count=1293\nself._frames = tuple(reversed(frames)) - size=13.0 KiB, count=278\nvx.io.write(reader, file_path) - size=1.9 KiB, count=33\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351690.vortex"}
{"ts": 1757351692.692399, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 78782188, "seconds": 2.1571}
{"ts": 1757351692.7404401, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 2159.947, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=53.1 KiB, count=1097\nself._frames = tuple(reversed(frames)) - size=22.1 KiB, count=472\nprof = cProfile.Profile() - size=3.2 KiB, count=64\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.1 KiB, count=18\nvx.io.write(reader, file_path) - size=1.9 KiB, count=33", "rows": 5000000}
{"ts": 1757351693.390805, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 597.057, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\nself.writer = _parquet.ParquetWriter( - size=1.7 KiB, count=8", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351692.parquet"}
{"ts": 1757351693.441756, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 650.413, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=52.4 KiB, count=1081\nself._frames = tuple(reversed(frames)) - size=22.8 KiB, count=487\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=3.8 KiB, count=62\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.6 KiB, count=16", "rows": 5000000}
{"ts": 1757351695.4593012, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 16.855, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\ntraces = _get_traces() - size=53.0 KiB, count=1094\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\nSequence.__init__(self) - size=0.0 KiB, count=1", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351695.582902, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 72.135, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=13.0 KiB, count=277\ntraces = _get_traces() - size=62.3 KiB, count=1292\narray = self.to_arrow_array() - size=5.0 KiB, count=104\nyield pa.table(base_data) - size=10.8 KiB, count=215\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4"}
{"ts": 1757351695.58391, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 5000000, "seconds": 0.1942}
{"ts": 1757351695.6373, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 200.32, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=52.9 KiB, count=1092\nself._frames = tuple(reversed(frames)) - size=22.5 KiB, count=479\narray = self.to_arrow_array() - size=4.8 KiB, count=100\nyield pa.table(base_data) - size=10.8 KiB, count=215\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.1 KiB, count=19", "rows": 5000000}
{"ts": 1757351696.343115, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 56.762, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.6 KiB, count=8\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.5 KiB, count=14\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3\nfactory = FileSystemDatasetFactory(fs, paths_or_selector, format, options) - size=0.1 KiB, count=2\nmarkers = {} - size=0.1 KiB, count=1", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351696.395128, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 112.549, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1160.6 KiB, count=12360\ntraces = _get_traces() - size=53.1 KiB, count=1095\nself._frames = tuple(reversed(frames)) - size=22.5 KiB, count=481\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.5 KiB, count=14\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=4.1 KiB, count=67", "rows": 5000000}
{"ts": 1757351696.396343, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 5000000, "write_ratio": 0.3003, "read_ratio": 0.5649, "size_ratio": 1.4551}
{"ts": 1757351696.4467762, "label": "full_benchmark_profile", "block": "format_comparison.full", "duration_ms": 59566.034, "cpu_profile": "benchmark_results/format_comparison.full.prof", "mem_top": "lines = fp.readlines() - size=1160.6 KiB, count=12360\ncallers[func] = nc, cc, tt, ct - size=24.7 KiB, count=153\ntraces = _get_traces() - size=43.2 KiB, count=886\nentries = self.getstats() - size=25.4 KiB, count=957\nself._frames = tuple(reversed(frames)) - size=31.9 KiB, count=680", "sizes": [100000, 500000, 1500000, 5000000]}
{"ts": 1757351697.395527, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 896.574, "cpu_profile": null, "mem_top": "'id': np.arange(num_rows, dtype=np.int64), - size=1953.6 KiB, count=9\n'value': np.arange(num_rows, dtype=np.float64) * 1.1, - size=1953.2 KiB, count=2\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=1953.2 KiB, count=2\nreturn pa.table(base_data) - size=1.4 KiB, count=27\nFile \"<frozen abc>\", line 119 - size=0.3 KiB, count=5", "rows": 250000, "complexity": "simple"}
{"ts": 1757351697.4524102, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 2.594, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\ntraces = _get_traces() - size=42.5 KiB, count=895"}
{"ts": 1757351697.606814, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 83.924, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=55.8 KiB, count=1179\nself._frames = tuple(reversed(frames)) - size=13.4 KiB, count=286\nvx.io.write(reader, file_path) - size=2.1 KiB, count=38\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351697.vortex"}
{"ts": 1757351697.607939, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 2906936, "seconds": 0.2087}
{"ts": 1757351697.656106, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 211.541, "cpu_profile": null, "mem_top": "return (abs(self.size_diff), self.size, - size=20.6 KiB, count=265\ntraces = _get_traces() - size=47.7 KiB, count=1007\nreturn (code.co_filename, code.co_firstlineno, code.co_name) - size=0.0 KiB, count=0\nself._frames = tuple(reversed(frames)) - size=24.1 KiB, count=514\nentries = self.getstats() - size=0.0 KiB, count=0", "rows": 250000}
{"ts": 1757351697.743399, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 33.765, "cpu_profile": null, "mem_top": "def _stringify_path(path): - size=0.3 KiB, count=4\nwith ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351697.parquet"}
{"ts": 1757351697.792879, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 86.418, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=52.6 KiB, count=1110\nself._frames = tuple(reversed(frames)) - size=20.7 KiB, count=442\ndef _stringify_path(path): - size=0.3 KiB, count=4\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nreturn (abs(self.size_diff), self.size, - size=21.0 KiB, count=270", "rows": 250000}
{"ts": 1757351697.950001, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 4.641, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=6\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.4 KiB, count=6\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351698.01131, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 6.542, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=12.4 KiB, count=265\ntraces = _get_traces() - size=65.7 KiB, count=1388\narray = self.to_arrow_array() - size=5.9 KiB, count=122\nprof.enable() - size=8.0 KiB, count=137\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4"}
{"ts": 1757351698.013257, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 250000, "seconds": 0.122}
{"ts": 1757351698.06777, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 125.357, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=57.3 KiB, count=1209\nself._frames = tuple(reversed(frames)) - size=21.1 KiB, count=450\narray = self.to_arrow_array() - size=5.7 KiB, count=118\nreturn (abs(self.size_diff), self.size, - size=21.6 KiB, count=278\nvortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5", "rows": 250000}
{"ts": 1757351698.163063, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 6.881, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.5 KiB, count=7\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=5\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=5", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351698.213702, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 61.62, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=58.6 KiB, count=1238\nself._frames = tuple(reversed(frames)) - size=23.7 KiB, count=505\nreturn (abs(self.size_diff), self.size, - size=22.7 KiB, count=292\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndef __getattr__(name): - size=0.3 KiB, count=5", "rows": 250000}
{"ts": 1757351698.21491, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 250000, "write_ratio": 0.4019, "read_ratio": 0.4825, "size_ratio": 1.8308}
{"ts": 1757351702.6162088, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 4350.343, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=5859.9 KiB, count=10\n'id': np.arange(num_rows, dtype=np.int64), - size=5859.8 KiB, count=8\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=5859.7 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=5859.5 KiB, count=2\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=5859.5 KiB, count=2", "rows": 750000, "complexity": "medium"}
{"ts": 1757351702.672742, "label": "full_benchmark_profile", "block": "vortex.write.default_reader", "duration_ms": 2.564, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nprof.enable() - size=8.2 KiB, count=140\nSequence.__init__(self) - size=0.0 KiB, count=1"}
{"ts": 1757351703.0133178, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 289.716, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=73.7 KiB, count=1558\nself._frames = tuple(reversed(frames)) - size=13.4 KiB, count=285\nvx.io.write(reader, file_path) - size=2.1 KiB, count=38\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351702.vortex"}
{"ts": 1757351703.014411, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 10353444, "seconds": 0.3945}
{"ts": 1757351703.063133, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 397.286, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.0 KiB, count=1310\nself._frames = tuple(reversed(frames)) - size=24.8 KiB, count=528\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.3 KiB, count=22\nprof = cProfile.Profile() - size=4.1 KiB, count=84\nwith self.instr.profile_block(\"vortex.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 750000}
{"ts": 1757351703.2136111, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 94.894, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\nself.writer = _parquet.ParquetWriter( - size=1.7 KiB, count=8", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351703.parquet"}
{"ts": 1757351703.2667332, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 151.927, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=63.7 KiB, count=1346\nself._frames = tuple(reversed(frames)) - size=23.3 KiB, count=497\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nyield pa.table(base_data) - size=9.0 KiB, count=180\nstat = stats[traceback] - size=0.0 KiB, count=0", "rows": 750000}
{"ts": 1757351703.619808, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 5.495, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=63.3 KiB, count=1337\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\nprof.enable() - size=8.3 KiB, count=142", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351703.684347, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 12.579, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=73.5 KiB, count=1554\nself._frames = tuple(reversed(frames)) - size=13.6 KiB, count=291\narray = self.to_arrow_array() - size=6.5 KiB, count=133\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4\nwith self.instr.profile_block(\"vortex.read.to_arrow_table\"): - size=0.1 KiB, count=1"}
{"ts": 1757351703.685376, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 750000, "seconds": 0.1224}
{"ts": 1757351703.737667, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 126.47, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=63.1 KiB, count=1333\nself._frames = tuple(reversed(frames)) - size=24.0 KiB, count=512\narray = self.to_arrow_array() - size=6.4 KiB, count=132\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.3 KiB, count=22\nwith self.instr.profile_block(\"vortex.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 750000}
{"ts": 1757351703.903776, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 14.891, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\ntable = self._dataset.to_table( - size=0.6 KiB, count=8\ntraces = _get_traces() - size=63.4 KiB, count=1338\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3\nfactory = FileSystemDatasetFactory(fs, paths_or_selector, format, options) - size=0.1 KiB, count=2", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351703.955553, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 70.531, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=63.7 KiB, count=1344\nself._frames = tuple(reversed(frames)) - size=23.4 KiB, count=500\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=4.5 KiB, count=76\nwith self.instr.profile_block(\"parquet.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 750000}
{"ts": 1757351703.9567418, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 750000, "write_ratio": 0.376, "read_ratio": 0.5533, "size_ratio": 1.6569}
{"ts": 1757351743.168648, "label": "full_benchmark_profile", "block": "data.generate", "duration_ms": 39159.41, "cpu_profile": null, "mem_top": "'order_total': (np.arange(start_idx, start_idx + current_chunk_size) % 10000).astype(np.float64) + 50.0, - size=15627.2 KiB, count=60\n'timestamp': np.arange(1000000 + start_idx, 1000000 + start_idx + current_chunk_size, dtype=np.int64), - size=15627.2 KiB, count=59\n'price': (np.arange(start_idx, start_idx + current_chunk_size) % 1000).astype(np.float64) + 0.99, - size=15627.0 KiB, count=43\n'id': np.arange(start_idx, start_idx + current_chunk_size, dtype=np.int64), - size=15626.9 KiB, count=41\n'value': np.arange(start_idx, start_idx + current_chunk_size, dtype=np.float64) * 1.5, - size=15626.9 KiB, count=40", "rows": 2000000, "complexity": "complex"}
{"ts": 1757351743.227312, "label": "full_benchmark_profile", "block": "vortex.write.batch_size_calc", "duration_ms": 2.807, "cpu_profile": null, "mem_top": "def _calculate_optimal_vortex_batch_size(table: pa.Table) -> int: - size=0.2 KiB, count=3\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.batch_size_calc\", {\"rows\": num_rows}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=63.5 KiB, count=1340", "rows": 2000000}
{"ts": 1757351743.283848, "label": "full_benchmark_profile", "block": "vortex.write.to_batches", "duration_ms": 3.353, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=76.0 KiB, count=1606\nself._frames = tuple(reversed(frames)) - size=13.6 KiB, count=291\nbatches = table.to_batches(max_chunksize=optimal_batch_size) - size=1.8 KiB, count=22\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "target_batch": 400000}
{"ts": 1757351743.340811, "label": "full_benchmark_profile", "block": "vortex.write.layout_optimize", "duration_ms": 2.843, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=75.8 KiB, count=1603\nself._frames = tuple(reversed(frames)) - size=13.7 KiB, count=292\noptimized_batches = combined_table.to_batches(max_chunksize=target_batch_size) - size=1.6 KiB, count=20\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=10\nreturn list(optimized_batches) - size=0.2 KiB, count=2", "batches": 20}
{"ts": 1757351743.399072, "label": "full_benchmark_profile", "block": "vortex.write.reader_from_batches", "duration_ms": 2.818, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=76.6 KiB, count=1619\nself._frames = tuple(reversed(frames)) - size=13.7 KiB, count=293\nself.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nreader = pa.RecordBatchReader.from_batches(table.schema, optimized_batches) - size=0.1 KiB, count=2"}
{"ts": 1757351744.443042, "label": "full_benchmark_profile", "block": "vortex.write.io", "duration_ms": 990.006, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=77.2 KiB, count=1630\nself._frames = tuple(reversed(frames)) - size=13.9 KiB, count=296\nvx.io.write(reader, file_path) - size=2.1 KiB, count=38\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nself.traces = _Traces(traces) - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_vortex_1757351743.vortex"}
{"ts": 1757351744.444226, "label": "full_benchmark_profile", "event": "vortex.write.complete", "bytes": 40882368, "seconds": 1.2716}
{"ts": 1757351744.496593, "label": "full_benchmark_profile", "block": "vortex.write.total", "duration_ms": 1274.645, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=65.6 KiB, count=1385\nself._frames = tuple(reversed(frames)) - size=25.2 KiB, count=538\nreturn (abs(self.size_diff), self.size, - size=24.1 KiB, count=310\nyield pa.table(base_data) - size=11.2 KiB, count=221\ntotal_rows = sum(len(batch) for batch in batches) - size=0.6 KiB, count=10", "rows": 2000000}
{"ts": 1757351744.9222558, "label": "full_benchmark_profile", "block": "parquet.write", "duration_ms": 368.467, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nprof.enable() - size=8.3 KiB, count=144\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/test_parquet_1757351744.parquet"}
{"ts": 1757351744.978035, "label": "full_benchmark_profile", "block": "parquet.write.total", "duration_ms": 425.908, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=65.9 KiB, count=1391\nself._frames = tuple(reversed(frames)) - size=25.6 KiB, count=546\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=4.6 KiB, count=78\nprof.enable() - size=7.9 KiB, count=142", "rows": 2000000}
{"ts": 1757351746.090692, "label": "full_benchmark_profile", "block": "vortex.read.read_url", "duration_ms": 11.453, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.3 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=65.0 KiB, count=1371\nprof.enable() - size=8.4 KiB, count=145", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/vortex_read_test.vortex"}
{"ts": 1757351746.19095, "label": "full_benchmark_profile", "block": "vortex.read.to_arrow_table", "duration_ms": 43.482, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=13.6 KiB, count=290\ntraces = _get_traces() - size=78.3 KiB, count=1655\narray = self.to_arrow_array() - size=6.6 KiB, count=134\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4\nprof.enable() - size=8.3 KiB, count=143"}
{"ts": 1757351746.192649, "label": "full_benchmark_profile", "event": "vortex.read.complete", "rows": 2000000, "seconds": 0.1689}
{"ts": 1757351746.2465322, "label": "full_benchmark_profile", "block": "vortex.read.total", "duration_ms": 174.237, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=67.9 KiB, count=1432\nself._frames = tuple(reversed(frames)) - size=24.0 KiB, count=513\narray = self.to_arrow_array() - size=6.4 KiB, count=131\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.5 KiB, count=25\nwith self.instr.profile_block(\"vortex.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 2000000}
{"ts": 1757351746.6919732, "label": "full_benchmark_profile", "block": "parquet.read", "duration_ms": 23.688, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=1.3 KiB, count=13\ntable = self._dataset.to_table( - size=0.6 KiB, count=8\nyield pa.table(base_data) - size=10.8 KiB, count=214\nprof.enable() - size=8.4 KiB, count=145\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp528aylod/parquet_read_test.parquet"}
{"ts": 1757351746.745153, "label": "full_benchmark_profile", "block": "parquet.read.total", "duration_ms": 80.189, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=68.3 KiB, count=1440\nself._frames = tuple(reversed(frames)) - size=25.2 KiB, count=537\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.3 KiB, count=13\nyield pa.table(base_data) - size=10.8 KiB, count=214\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=4.8 KiB, count=81", "rows": 2000000}
{"ts": 1757351746.7463748, "label": "full_benchmark_profile", "event": "comparison.metrics", "rows": 2000000, "write_ratio": 0.3326, "read_ratio": 0.4556, "size_ratio": 1.1997}
{"ts": 1757351746.8002229, "label": "full_benchmark_profile", "block": "production.scenarios", "duration_ms": 50309.468, "cpu_profile": "benchmark_results/production.scenarios.prof", "mem_top": "callers[func] = nc, cc, tt, ct - size=22.6 KiB, count=140\ntraces = _get_traces() - size=56.4 KiB, count=1188\nentries = self.getstats() - size=23.9 KiB, count=894\nreturn (abs(self.size_diff), self.size, - size=13.2 KiB, count=170\ncallers = {} - size=8.8 KiB, count=141"}
{"ts": 1757365332.175531, "label": "streaming_benchmark", "block": "data.generate", "duration_ms": 570.449, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=5\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757365332.186352, "label": "streaming_benchmark", "block": "vortex.write.default_reader", "duration_ms": 0.259, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=13\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757365332.245686, "label": "streaming_benchmark", "block": "vortex.write.io", "duration_ms": 47.609, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.3 KiB, count=173\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpgb6aj8ou/test_vortex_1757365332.vortex"}
{"ts": 1757365332.2461922, "label": "streaming_benchmark", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0694}
{"ts": 1757365332.255949, "label": "streaming_benchmark", "block": "vortex.write.total", "duration_ms": 70.011, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=209.8 KiB, count=2152\nself._frames = tuple(reversed(frames)) - size=10.2 KiB, count=217\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=176\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757365332.274233, "label": "streaming_benchmark", "block": "vortex.write.streaming_io", "duration_ms": 3.39, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.8 KiB, count=6\nself.gen.throw(value) - size=0.3 KiB, count=4\nbatch_generator(table, compress) - size=0.0 KiB, count=0\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3\nself.traces = _Traces(traces) - size=0.8 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpgb6aj8ou/test_vortex_streaming_1757365332.vortex", "compress": false}
{"ts": 1757365332.288553, "label": "streaming_benchmark", "block": "vortex.write.streaming", "duration_ms": 18.539, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=10.8 KiB, count=225\nreturn (abs(self.size_diff), self.size, - size=15.7 KiB, count=202\nself._frames = tuple(reversed(frames)) - size=16.5 KiB, count=353\nvx.io.write(array_iterator, file_path) - size=0.8 KiB, count=5\nvortex_streaming_write_time, vortex_streaming_size = self.benchmark_vortex_write_streaming(table, compress=False) - size=0.6 KiB, count=3", "rows": 100000}
{"ts": 1757365332.2983391, "label": "streaming_benchmark", "block": "format_comparison.quick", "duration_ms": 687.593, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=5\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "sizes": [100000, 500000]}
{"ts": 1757365417.977105, "label": "streaming_benchmark", "block": "data.generate", "duration_ms": 561.374, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757365417.986112, "label": "streaming_benchmark", "block": "vortex.write.default_reader", "duration_ms": 0.292, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757365418.044428, "label": "streaming_benchmark", "block": "vortex.write.io", "duration_ms": 46.666, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/test_vortex_1757365417.vortex"}
{"ts": 1757365418.044873, "label": "streaming_benchmark", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0671}
{"ts": 1757365418.0544379, "label": "streaming_benchmark", "block": "vortex.write.total", "duration_ms": 67.661, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=210.1 KiB, count=2155\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=216\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757365418.0712872, "label": "streaming_benchmark", "block": "vortex.write.streaming", "duration_ms": 0.649, "cpu_profile": null, "mem_top": "vortex_dtype = vx.struct(vortex_dtype.fields(), nullable=False) - size=0.5 KiB, count=8\ntraces = _get_traces() - size=4.0 KiB, count=80\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.4 KiB, count=6\nself._frames = tuple(reversed(frames)) - size=14.7 KiB, count=313\ndef __setattr__(self, attr, val): - size=0.3 KiB, count=4", "rows": 100000}
{"ts": 1757365418.095208, "label": "streaming_benchmark", "block": "vortex.write.streaming_compressed", "duration_ms": 1.322, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.2 KiB, count=171\nself._frames = tuple(reversed(frames)) - size=10.4 KiB, count=222\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=2\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757365418.1451252, "label": "streaming_benchmark", "block": "parquet.write", "duration_ms": 21.536, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/test_parquet_1757365418.parquet"}
{"ts": 1757365418.173836, "label": "streaming_benchmark", "block": "parquet.write.total", "duration_ms": 49.883, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=900.2 KiB, count=9658\nself._frames = tuple(reversed(frames)) - size=17.5 KiB, count=374\ntraces = _get_traces() - size=12.7 KiB, count=266\nreturn (abs(self.size_diff), self.size, - size=17.4 KiB, count=223\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7", "rows": 100000}
{"ts": 1757365418.2603872, "label": "streaming_benchmark", "block": "vortex.read.read_url", "duration_ms": 3.215, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nself.traces = _Traces(traces) - size=0.7 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.4 KiB, count=6\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.1 KiB, count=1", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/vortex_read_test.vortex"}
{"ts": 1757365418.2995079, "label": "streaming_benchmark", "block": "vortex.read.to_arrow_table", "duration_ms": 2.976, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=26.1 KiB, count=551\nself._frames = tuple(reversed(frames)) - size=10.8 KiB, count=231\narray = self.to_arrow_array() - size=1.7 KiB, count=33\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757365418.300396, "label": "streaming_benchmark", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0777}
{"ts": 1757365418.336054, "label": "streaming_benchmark", "block": "vortex.read.total", "duration_ms": 79.766, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=928.6 KiB, count=9987\ntraces = _get_traces() - size=19.0 KiB, count=400\narray = self.to_arrow_array() - size=1.7 KiB, count=33\nself._frames = tuple(reversed(frames)) - size=18.2 KiB, count=388\nreturn (abs(self.size_diff), self.size, - size=18.7 KiB, count=240", "rows": 100000}
{"ts": 1757365418.402824, "label": "streaming_benchmark", "block": "parquet.read", "duration_ms": 5.49, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=4\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=4\ndef read_table(source, *, columns=None, use_threads=True, - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/parquet_read_test.parquet"}
{"ts": 1757365418.459703, "label": "streaming_benchmark", "block": "parquet.read.total", "duration_ms": 47.706, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=960.9 KiB, count=10346\ntraces = _get_traces() - size=23.2 KiB, count=490\nreturn (abs(self.size_diff), self.size, - size=21.3 KiB, count=273\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3\ndef __getattr__(name): - size=0.3 KiB, count=5", "rows": 100000}
{"ts": 1757365418.46079, "label": "streaming_benchmark", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.7155, "read_ratio": 0.5868, "size_ratio": 1.9323}
{"ts": 1757365421.2464309, "label": "streaming_benchmark", "block": "data.generate", "duration_ms": 2747.708, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=8\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757365421.2910001, "label": "streaming_benchmark", "block": "vortex.write.default_reader", "duration_ms": 1.964, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=31.3 KiB, count=662\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=4\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nsuper().__init__(*args) - size=0.0 KiB, count=0"}
{"ts": 1757365421.524118, "label": "streaming_benchmark", "block": "vortex.write.io", "duration_ms": 190.837, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=46.9 KiB, count=994\nself._frames = tuple(reversed(frames)) - size=12.9 KiB, count=275\nvx.io.write(reader, file_path) - size=0.7 KiB, count=12\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/test_vortex_1757365421.vortex"}
{"ts": 1757365421.525151, "label": "streaming_benchmark", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.276}
{"ts": 1757365421.565274, "label": "streaming_benchmark", "block": "vortex.write.total", "duration_ms": 278.032, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1028.9 KiB, count=11090\ntraces = _get_traces() - size=38.9 KiB, count=824\nself._frames = tuple(reversed(frames)) - size=22.0 KiB, count=469\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nreturn (abs(self.size_diff), self.size, - size=22.5 KiB, count=289", "rows": 500000}
{"ts": 1757365421.61164, "label": "streaming_benchmark", "block": "vortex.write.streaming", "duration_ms": 2.123, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.1 KiB, count=741\nself._frames = tuple(reversed(frames)) - size=25.6 KiB, count=546\ndef batch_generator(tbl: pa.Table, do_compress: bool) -> Iterator[vx.Array]: - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.streaming\", {\"rows\": num_rows}): - size=0.2 KiB, count=3\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.6 KiB, count=10", "rows": 500000}
{"ts": 1757365421.660222, "label": "streaming_benchmark", "block": "vortex.write.streaming_compressed", "duration_ms": 2.797, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.0 KiB, count=739\nself._frames = tuple(reversed(frames)) - size=25.8 KiB, count=550\nwith self.instr.profile_block(\"vortex.write.streaming_compressed\", {\"rows\": num_rows}): - size=0.2 KiB, count=3\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.7 KiB, count=12\ndef batch_generator(tbl: pa.Table, do_compress: bool) -> Iterator[vx.Array]: - size=0.2 KiB, count=3", "rows": 500000}
{"ts": 1757365421.7785668, "label": "streaming_benchmark", "block": "parquet.write", "duration_ms": 71.275, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nself.writer = _parquet.ParquetWriter( - size=1.7 KiB, count=8", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/test_parquet_1757365421.parquet"}
{"ts": 1757365421.822322, "label": "streaming_benchmark", "block": "parquet.write.total", "duration_ms": 118.356, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=35.8 KiB, count=756\nself._frames = tuple(reversed(frames)) - size=25.7 KiB, count=549\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.5 KiB, count=23\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=9", "rows": 500000}
{"ts": 1757365422.06989, "label": "streaming_benchmark", "block": "vortex.read.read_url", "duration_ms": 4.408, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=38.7 KiB, count=819\nreturn type(self)(*pathsegments) - size=0.1 KiB, count=1", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/vortex_read_test.vortex"}
{"ts": 1757365422.126966, "label": "streaming_benchmark", "block": "vortex.read.to_arrow_table", "duration_ms": 9.595, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=13.0 KiB, count=278\ntraces = _get_traces() - size=49.0 KiB, count=1036\narray = self.to_arrow_array() - size=3.0 KiB, count=60\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4\nwith self.instr.profile_block(\"vortex.read.to_arrow_table\"): - size=0.1 KiB, count=1"}
{"ts": 1757365422.1279411, "label": "streaming_benchmark", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.1121}
{"ts": 1757365422.172391, "label": "streaming_benchmark", "block": "vortex.read.total", "duration_ms": 114.792, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1112.9 KiB, count=12023\ntraces = _get_traces() - size=36.8 KiB, count=777\nself._frames = tuple(reversed(frames)) - size=25.1 KiB, count=536\narray = self.to_arrow_array() - size=2.9 KiB, count=57\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10", "rows": 500000}
{"ts": 1757365422.3009868, "label": "streaming_benchmark", "block": "parquet.read", "duration_ms": 11.652, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.5 KiB, count=7\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndataset = ParquetDataset( - size=0.1 KiB, count=1\nreturn _filesystem_dataset(source, **kwargs) - size=0.1 KiB, count=2\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpko5n4orn/parquet_read_test.parquet"}
{"ts": 1757365422.347787, "label": "streaming_benchmark", "block": "parquet.read.total", "duration_ms": 62.177, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1196.6 KiB, count=12920\ntraces = _get_traces() - size=39.0 KiB, count=825\nself._frames = tuple(reversed(frames)) - size=23.2 KiB, count=494\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ntable = self._dataset.to_table( - size=0.3 KiB, count=3", "rows": 500000}
{"ts": 1757365422.348927, "label": "streaming_benchmark", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4205, "read_ratio": 0.5332, "size_ratio": 1.7877}
{"ts": 1757365422.3755038, "label": "streaming_benchmark", "block": "format_comparison.quick", "duration_ms": 4936.927, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=1196.6 KiB, count=12920\nself._frames = tuple(reversed(frames)) - size=34.4 KiB, count=733\ntraces = _get_traces() - size=27.4 KiB, count=578\ncallers[func] = nc, cc, tt, ct - size=27.0 KiB, count=165\nentries = self.getstats() - size=26.2 KiB, count=994", "sizes": [100000, 500000]}
{"ts": 1757365660.194508, "label": "streaming_benchmark_fix_2", "block": "data.generate", "duration_ms": 565.82, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757365660.205219, "label": "streaming_benchmark_fix_2", "block": "vortex.write.default_reader", "duration_ms": 0.26, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757365660.2661278, "label": "streaming_benchmark_fix_2", "block": "vortex.write.io", "duration_ms": 48.088, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_1757365660.vortex"}
{"ts": 1757365660.266641, "label": "streaming_benchmark_fix_2", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0707}
{"ts": 1757365660.277823, "label": "streaming_benchmark_fix_2", "block": "vortex.write.total", "duration_ms": 71.324, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=210.3 KiB, count=2157\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=216\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757365660.2951648, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_io", "duration_ms": 0.899, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nreturn Array.from_arrow(obj) - size=0.4 KiB, count=7\nself.gen.throw(value) - size=0.3 KiB, count=4\nbatch_generator(table, compress) - size=0.0 KiB, count=0\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_streaming_1757365660.vortex", "compress": false}
{"ts": 1757365660.310484, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming", "duration_ms": 17.499, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=255.3 KiB, count=2681\ntraces = _get_traces() - size=11.3 KiB, count=235\nreturn (abs(self.size_diff), self.size, - size=16.3 KiB, count=209\nself._frames = tuple(reversed(frames)) - size=17.2 KiB, count=368\nreturn Array.from_arrow(obj) - size=0.4 KiB, count=7", "rows": 100000}
{"ts": 1757365660.329273, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_io", "duration_ms": 0.809, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nbatch_generator(table, compress) - size=0.0 KiB, count=0\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3\nself.traces = _Traces(traces) - size=0.7 KiB, count=3\nreturn Array.from_arrow(obj) - size=0.5 KiB, count=10", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_streaming_1757365660.vortex", "compress": true}
{"ts": 1757365660.347645, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_compressed", "duration_ms": 19.038, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=17.8 KiB, count=374\nself._frames = tuple(reversed(frames)) - size=13.2 KiB, count=282\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=2\nreturn Array.from_arrow(obj) - size=0.5 KiB, count=10", "rows": 100000}
{"ts": 1757365660.389005, "label": "streaming_benchmark_fix_2", "block": "parquet.write", "duration_ms": 20.863, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_parquet_1757365660.parquet"}
{"ts": 1757365660.411297, "label": "streaming_benchmark_fix_2", "block": "parquet.write.total", "duration_ms": 41.37, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=644.8 KiB, count=6919\ntraces = _get_traces() - size=16.3 KiB, count=342\nreturn (abs(self.size_diff), self.size, - size=18.3 KiB, count=235\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4", "rows": 100000}
{"ts": 1757365660.489588, "label": "streaming_benchmark_fix_2", "block": "vortex.read.read_url", "duration_ms": 2.602, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nself.traces = _Traces(traces) - size=0.6 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.6 KiB, count=3\nprof.enable() - size=3.7 KiB, count=54\ndef __exit__(self, typ, value, traceback): - size=0.5 KiB, count=7", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/vortex_read_test.vortex"}
{"ts": 1757365660.5219939, "label": "streaming_benchmark_fix_2", "block": "vortex.read.to_arrow_table", "duration_ms": 2.578, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=28.3 KiB, count=598\nself._frames = tuple(reversed(frames)) - size=11.1 KiB, count=236\narray = self.to_arrow_array() - size=1.1 KiB, count=21\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757365660.522746, "label": "streaming_benchmark_fix_2", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0637}
{"ts": 1757365660.568942, "label": "streaming_benchmark_fix_2", "block": "vortex.read.total", "duration_ms": 65.52, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=656.2 KiB, count=7043\ntraces = _get_traces() - size=22.1 KiB, count=465\nself._frames = tuple(reversed(frames)) - size=18.2 KiB, count=388\nreturn (abs(self.size_diff), self.size, - size=19.6 KiB, count=252\narray = self.to_arrow_array() - size=1.1 KiB, count=21", "rows": 100000}
{"ts": 1757365660.628034, "label": "streaming_benchmark_fix_2", "block": "parquet.read", "duration_ms": 4.983, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6\ntable = self._dataset.to_table( - size=0.5 KiB, count=7\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=4\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=4", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/parquet_read_test.parquet"}
{"ts": 1757365660.660693, "label": "streaming_benchmark_fix_2", "block": "parquet.read.total", "duration_ms": 39.943, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=688.7 KiB, count=7404\ntraces = _get_traces() - size=34.6 KiB, count=731\nreturn (abs(self.size_diff), self.size, - size=22.9 KiB, count=294\nself._frames = tuple(reversed(frames)) - size=25.5 KiB, count=543\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6", "rows": 100000}
{"ts": 1757365660.661599, "label": "streaming_benchmark_fix_2", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.5737, "read_ratio": 0.5992, "size_ratio": 1.9323}
{"ts": 1757365663.513282, "label": "streaming_benchmark_fix_2", "block": "data.generate", "duration_ms": 2815.963, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=8\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757365663.550132, "label": "streaming_benchmark_fix_2", "block": "vortex.write.default_reader", "duration_ms": 1.512, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\ntraces = _get_traces() - size=41.8 KiB, count=885\nprof.enable() - size=4.2 KiB, count=64"}
{"ts": 1757365663.777269, "label": "streaming_benchmark_fix_2", "block": "vortex.write.io", "duration_ms": 193.503, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=54.1 KiB, count=1146\nself._frames = tuple(reversed(frames)) - size=13.7 KiB, count=293\nvx.io.write(reader, file_path) - size=0.7 KiB, count=12\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nprof.enable() - size=4.2 KiB, count=64", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_1757365663.vortex"}
{"ts": 1757365663.778055, "label": "streaming_benchmark_fix_2", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2619}
{"ts": 1757365663.811116, "label": "streaming_benchmark_fix_2", "block": "vortex.write.total", "duration_ms": 263.754, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=40.9 KiB, count=865\nself._frames = tuple(reversed(frames)) - size=26.7 KiB, count=569\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nreturn (abs(self.size_diff), self.size, - size=23.5 KiB, count=302\nvx.io.write(reader, file_path) - size=0.7 KiB, count=12", "rows": 500000}
{"ts": 1757365663.848869, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_io", "duration_ms": 1.994, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table, compress) - size=0.0 KiB, count=0\nreturn Array.from_arrow(obj) - size=0.6 KiB, count=11\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_streaming_1757365663.vortex", "compress": false}
{"ts": 1757365663.88379, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming", "duration_ms": 37.78, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=44.7 KiB, count=946\nself._frames = tuple(reversed(frames)) - size=23.6 KiB, count=503\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.5 KiB, count=24\nwith self.instr.profile_block(\"vortex.write.streaming\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nreturn Array.from_arrow(obj) - size=0.6 KiB, count=11", "rows": 500000}
{"ts": 1757365663.924351, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_io", "duration_ms": 2.189, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table, compress) - size=0.0 KiB, count=0\nreturn Array.from_arrow(obj) - size=0.7 KiB, count=14\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_vortex_streaming_1757365663.vortex", "compress": true}
{"ts": 1757365663.959575, "label": "streaming_benchmark_fix_2", "block": "vortex.write.streaming_compressed", "duration_ms": 40.853, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=42.7 KiB, count=903\nself._frames = tuple(reversed(frames)) - size=26.3 KiB, count=562\nwith self.instr.profile_block(\"vortex.write.streaming_compressed\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.6 KiB, count=25\nreturn Array.from_arrow(obj) - size=0.7 KiB, count=14", "rows": 500000}
{"ts": 1757365664.066528, "label": "streaming_benchmark_fix_2", "block": "parquet.write", "duration_ms": 70.807, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/test_parquet_1757365663.parquet"}
{"ts": 1757365664.102408, "label": "streaming_benchmark_fix_2", "block": "parquet.write.total", "duration_ms": 106.983, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=44.5 KiB, count=942\nself._frames = tuple(reversed(frames)) - size=24.3 KiB, count=519\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=1\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.7 KiB, count=27\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=9", "rows": 500000}
{"ts": 1757365664.337876, "label": "streaming_benchmark_fix_2", "block": "vortex.read.read_url", "duration_ms": 3.934, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\nprof.enable() - size=4.8 KiB, count=76\nvortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/vortex_read_test.vortex"}
{"ts": 1757365664.3828008, "label": "streaming_benchmark_fix_2", "block": "vortex.read.to_arrow_table", "duration_ms": 8.87, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=54.9 KiB, count=1162\nself._frames = tuple(reversed(frames)) - size=14.1 KiB, count=301\narray = self.to_arrow_array() - size=2.1 KiB, count=42\nwith self.instr.profile_block(\"vortex.read.to_arrow_table\"): - size=0.1 KiB, count=1\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3"}
{"ts": 1757365664.383559, "label": "streaming_benchmark_fix_2", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0846}
{"ts": 1757365664.418946, "label": "streaming_benchmark_fix_2", "block": "vortex.read.total", "duration_ms": 87.061, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=43.6 KiB, count=923\nself._frames = tuple(reversed(frames)) - size=25.3 KiB, count=540\narray = self.to_arrow_array() - size=2.0 KiB, count=39\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nprof = cProfile.Profile() - size=2.2 KiB, count=44", "rows": 500000}
{"ts": 1757365664.5340412, "label": "streaming_benchmark_fix_2", "block": "parquet.read", "duration_ms": 10.951, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=1.0 KiB, count=10\ntable = self._dataset.to_table( - size=0.6 KiB, count=8\nmarkers = {} - size=0.0 KiB, count=0\ntraces = _get_traces() - size=42.1 KiB, count=891\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpflcgbzix/parquet_read_test.parquet"}
{"ts": 1757365664.570741, "label": "streaming_benchmark_fix_2", "block": "parquet.read.total", "duration_ms": 49.608, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=791.8 KiB, count=8546\ntraces = _get_traces() - size=42.5 KiB, count=900\nself._frames = tuple(reversed(frames)) - size=26.3 KiB, count=561\nparquet_format = ds.ParquetFileFormat(**read_options) - size=1.0 KiB, count=10\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.9 KiB, count=30", "rows": 500000}
{"ts": 1757365664.571687, "label": "streaming_benchmark_fix_2", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4018, "read_ratio": 0.5647, "size_ratio": 1.7877}
{"ts": 1757365664.59224, "label": "streaming_benchmark_fix_2", "block": "format_comparison.quick", "duration_ms": 4946.591, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=791.8 KiB, count=8546\nself._frames = tuple(reversed(frames)) - size=35.7 KiB, count=762\ntraces = _get_traces() - size=32.8 KiB, count=693\ncallers[func] = nc, cc, tt, ct - size=28.1 KiB, count=170\nentries = self.getstats() - size=26.9 KiB, count=1028", "sizes": [100000, 500000]}
{"ts": 1757368561.458038, "label": "streaming_benchmark_fix_final", "block": "data.generate", "duration_ms": 565.23, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=5\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757368561.467357, "label": "streaming_benchmark_fix_final", "block": "vortex.write.default_reader", "duration_ms": 0.271, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757368561.531029, "label": "streaming_benchmark_fix_final", "block": "vortex.write.io", "duration_ms": 51.509, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/test_vortex_1757368561.vortex"}
{"ts": 1757368561.53147, "label": "streaming_benchmark_fix_final", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0725}
{"ts": 1757368561.541496, "label": "streaming_benchmark_fix_final", "block": "vortex.write.total", "duration_ms": 73.122, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=210.1 KiB, count=2153\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=215\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757368561.5578308, "label": "streaming_benchmark_fix_final", "block": "vortex.write.streaming", "duration_ms": 0.783, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=3.9 KiB, count=79\nself._frames = tuple(reversed(frames)) - size=14.5 KiB, count=310\ndef __setattr__(self, attr, val): - size=0.3 KiB, count=4\narray_iterator = vx.ArrayIterator.from_iter(batch_generator(table, compress)) - size=0.3 KiB, count=4\nself.__args__ = tuple(... if a is _TypingEllipsis else - size=0.2 KiB, count=4", "rows": 100000}
{"ts": 1757368561.581682, "label": "streaming_benchmark_fix_final", "block": "vortex.write.streaming_compressed", "duration_ms": 1.117, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.2 KiB, count=171\nself._frames = tuple(reversed(frames)) - size=10.4 KiB, count=222\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=2\ndef floatstr(o, allow_nan=self.allow_nan, - size=0.0 KiB, count=0", "rows": 100000}
{"ts": 1757368561.637154, "label": "streaming_benchmark_fix_final", "block": "parquet.write", "duration_ms": 27.373, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/test_parquet_1757368561.parquet"}
{"ts": 1757368561.6679091, "label": "streaming_benchmark_fix_final", "block": "parquet.write.total", "duration_ms": 55.492, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=935.4 KiB, count=10053\nself._frames = tuple(reversed(frames)) - size=17.4 KiB, count=371\ntraces = _get_traces() - size=12.4 KiB, count=259\nreturn (abs(self.size_diff), self.size, - size=17.0 KiB, count=219\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7", "rows": 100000}
{"ts": 1757368561.7580009, "label": "streaming_benchmark_fix_final", "block": "vortex.read.read_url", "duration_ms": 5.507, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3\nself.traces = _Traces(traces) - size=0.7 KiB, count=3\ntraces = _get_traces() - size=19.2 KiB, count=406\ndef __exit__(self, typ, value, traceback): - size=0.4 KiB, count=6", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/vortex_read_test.vortex"}
{"ts": 1757368561.79954, "label": "streaming_benchmark_fix_final", "block": "vortex.read.to_arrow_table", "duration_ms": 3.998, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=25.8 KiB, count=544\nself._frames = tuple(reversed(frames)) - size=10.7 KiB, count=228\narray = self.to_arrow_array() - size=0.9 KiB, count=17\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757368561.8003259, "label": "streaming_benchmark_fix_final", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0842}
{"ts": 1757368561.8373451, "label": "streaming_benchmark_fix_final", "block": "vortex.read.total", "duration_ms": 86.478, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=963.8 KiB, count=10382\ntraces = _get_traces() - size=18.7 KiB, count=394\nreturn (abs(self.size_diff), self.size, - size=18.5 KiB, count=238\nself._frames = tuple(reversed(frames)) - size=18.0 KiB, count=385\narray = self.to_arrow_array() - size=0.9 KiB, count=17", "rows": 100000}
{"ts": 1757368561.913167, "label": "streaming_benchmark_fix_final", "block": "parquet.read", "duration_ms": 15.156, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=4\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=4\ndef read_table(source, *, columns=None, use_threads=True, - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/parquet_read_test.parquet"}
{"ts": 1757368561.970392, "label": "streaming_benchmark_fix_final", "block": "parquet.read.total", "duration_ms": 57.138, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=996.2 KiB, count=10742\ntraces = _get_traces() - size=23.5 KiB, count=495\nreturn (abs(self.size_diff), self.size, - size=21.0 KiB, count=270\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3\ndef __getattr__(name): - size=0.3 KiB, count=5", "rows": 100000}
{"ts": 1757368561.971529, "label": "streaming_benchmark_fix_final", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.737, "read_ratio": 0.6555, "size_ratio": 1.9323}
{"ts": 1757368564.8196821, "label": "streaming_benchmark_fix_final", "block": "data.generate", "duration_ms": 2808.895, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=8\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=5\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757368564.864991, "label": "streaming_benchmark_fix_final", "block": "vortex.write.default_reader", "duration_ms": 2.043, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.5 KiB, count=4\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\ntraces = _get_traces() - size=30.7 KiB, count=649\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nsuper().__init__(*args) - size=0.0 KiB, count=0"}
{"ts": 1757368565.098573, "label": "streaming_benchmark_fix_final", "block": "vortex.write.io", "duration_ms": 189.407, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=46.2 KiB, count=978\nself._frames = tuple(reversed(frames)) - size=12.8 KiB, count=272\nvx.io.write(reader, file_path) - size=0.6 KiB, count=11\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nprof.enable() - size=3.9 KiB, count=58", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/test_vortex_1757368564.vortex"}
{"ts": 1757368565.099664, "label": "streaming_benchmark_fix_final", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2771}
{"ts": 1757368565.141633, "label": "streaming_benchmark_fix_final", "block": "vortex.write.total", "duration_ms": 279.265, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1075.5 KiB, count=11611\ntraces = _get_traces() - size=37.9 KiB, count=801\nself._frames = tuple(reversed(frames)) - size=22.2 KiB, count=474\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nreturn (abs(self.size_diff), self.size, - size=22.4 KiB, count=287", "rows": 500000}
{"ts": 1757368565.188224, "label": "streaming_benchmark_fix_final", "block": "vortex.write.streaming", "duration_ms": 2.174, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=25.4 KiB, count=542\ntraces = _get_traces() - size=34.3 KiB, count=726\ndef batch_generator(tbl: pa.Table, do_compress: bool) -> Iterator[vx.Array]: - size=0.2 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.streaming\", {\"rows\": num_rows}): - size=0.2 KiB, count=3\nreturn Snapshot(traces, traceback_limit) - size=0.4 KiB, count=2", "rows": 500000}
{"ts": 1757368565.2358809, "label": "streaming_benchmark_fix_final", "block": "vortex.write.streaming_compressed", "duration_ms": 2.402, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=34.3 KiB, count=724\nself._frames = tuple(reversed(frames)) - size=25.6 KiB, count=546\nwith self.instr.profile_block(\"vortex.write.streaming_compressed\", {\"rows\": num_rows}): - size=0.2 KiB, count=3\ndef batch_generator(tbl: pa.Table, do_compress: bool) -> Iterator[vx.Array]: - size=0.2 KiB, count=3\nreturn Snapshot(traces, traceback_limit) - size=0.4 KiB, count=2", "rows": 500000}
{"ts": 1757368565.355354, "label": "streaming_benchmark_fix_final", "block": "parquet.write", "duration_ms": 72.378, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nself.writer = _parquet.ParquetWriter( - size=1.7 KiB, count=8", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/test_parquet_1757368565.parquet"}
{"ts": 1757368565.399786, "label": "streaming_benchmark_fix_final", "block": "parquet.write.total", "duration_ms": 119.456, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=34.9 KiB, count=738\nself._frames = tuple(reversed(frames)) - size=25.6 KiB, count=546\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.5 KiB, count=23\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=9", "rows": 500000}
{"ts": 1757368565.640081, "label": "streaming_benchmark_fix_final", "block": "vortex.read.read_url", "duration_ms": 4.143, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\nprof.enable() - size=4.4 KiB, count=68\nvortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/vortex_read_test.vortex"}
{"ts": 1757368565.695439, "label": "streaming_benchmark_fix_final", "block": "vortex.read.to_arrow_table", "duration_ms": 9.68, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=12.9 KiB, count=276\ntraces = _get_traces() - size=48.2 KiB, count=1020\narray = self.to_arrow_array() - size=1.8 KiB, count=35\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4\nprof.enable() - size=4.4 KiB, count=67"}
{"ts": 1757368565.696335, "label": "streaming_benchmark_fix_final", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.1073}
{"ts": 1757368565.739837, "label": "streaming_benchmark_fix_final", "block": "vortex.read.total", "duration_ms": 109.938, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=36.6 KiB, count=773\nself._frames = tuple(reversed(frames)) - size=24.5 KiB, count=522\narray = self.to_arrow_array() - size=1.6 KiB, count=32\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.7 KiB, count=11\nwith self.instr.profile_block(\"vortex.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757368565.86704, "label": "streaming_benchmark_fix_final", "block": "parquet.read", "duration_ms": 11.448, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.6 KiB, count=8\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndataset = ParquetDataset( - size=0.1 KiB, count=1\nreturn _filesystem_dataset(source, **kwargs) - size=0.1 KiB, count=2\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpmpv_fhj0/parquet_read_test.parquet"}
{"ts": 1757368565.912585, "label": "streaming_benchmark_fix_final", "block": "parquet.read.total", "duration_ms": 60.69, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=1159.2 KiB, count=12508\ntraces = _get_traces() - size=38.2 KiB, count=807\nself._frames = tuple(reversed(frames)) - size=23.6 KiB, count=504\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ntable = self._dataset.to_table( - size=0.3 KiB, count=3", "rows": 500000}
{"ts": 1757368565.91378, "label": "streaming_benchmark_fix_final", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4227, "read_ratio": 0.5442, "size_ratio": 1.7877}
{"ts": 1757368565.939314, "label": "streaming_benchmark_fix_final", "block": "format_comparison.quick", "duration_ms": 5025.369, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=1159.2 KiB, count=12508\nself._frames = tuple(reversed(frames)) - size=33.0 KiB, count=703\ntraces = _get_traces() - size=28.5 KiB, count=601\ncallers[func] = nc, cc, tt, ct - size=26.6 KiB, count=163\nentries = self.getstats() - size=25.9 KiB, count=983", "sizes": [100000, 500000]}
{"ts": 1757368612.844119, "label": "streaming_benchmark_fix_final_2", "block": "data.generate", "duration_ms": 557.236, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757368612.853076, "label": "streaming_benchmark_fix_final_2", "block": "vortex.write.default_reader", "duration_ms": 0.253, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757368612.911464, "label": "streaming_benchmark_fix_final_2", "block": "vortex.write.io", "duration_ms": 46.656, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpckadioyj/test_vortex_1757368612.vortex"}
{"ts": 1757368612.9118679, "label": "streaming_benchmark_fix_final_2", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.067}
{"ts": 1757368612.921418, "label": "streaming_benchmark_fix_final_2", "block": "vortex.write.total", "duration_ms": 67.63, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=210.2 KiB, count=2155\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=216\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757368612.941092, "label": "streaming_benchmark_fix_final_2", "block": "vortex.write.streaming_io", "duration_ms": 4.003, "cpu_profile": null, "mem_top": "vx.io.write(array_iterator, file_path) - size=0.8 KiB, count=6\nbatch_generator(table) - size=0.0 KiB, count=0\nself.gen.throw(value) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3\nself.traces = _Traces(traces) - size=0.8 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpckadioyj/test_vortex_streaming_1757368612.vortex", "compress": false}
{"ts": 1757368612.954568, "label": "streaming_benchmark_fix_final_2", "block": "vortex.write.streaming", "duration_ms": 19.843, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=10.7 KiB, count=222\nreturn (abs(self.size_diff), self.size, - size=15.6 KiB, count=200\nself._frames = tuple(reversed(frames)) - size=16.5 KiB, count=352\nvx.io.write(array_iterator, file_path) - size=0.8 KiB, count=5\nvortex_streaming_write_time, vortex_streaming_size = self.benchmark_vortex_write_streaming(table, compress=False) - size=0.5 KiB, count=2", "rows": 100000}
{"ts": 1757368612.963857, "label": "streaming_benchmark_fix_final_2", "block": "format_comparison.quick", "duration_ms": 670.7, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "sizes": [100000, 500000]}
{"ts": 1757369979.457015, "label": "streaming_benchmark_fix_final_3", "block": "data.generate", "duration_ms": 566.102, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757369979.467127, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.default_reader", "duration_ms": 0.269, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4\ntraces = _get_traces() - size=0.7 KiB, count=12"}
{"ts": 1757369979.541295, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.io", "duration_ms": 62.095, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.2 KiB, count=171\nself._frames = tuple(reversed(frames)) - size=7.0 KiB, count=150\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_1757369979.vortex"}
{"ts": 1757369979.541739, "label": "streaming_benchmark_fix_final_3", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0837}
{"ts": 1757369979.551931, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.total", "duration_ms": 84.293, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=210.7 KiB, count=2161\nself._frames = tuple(reversed(frames)) - size=10.2 KiB, count=218\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.4 KiB, count=174\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757369979.568949, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_io", "duration_ms": 1.565, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=2.2 KiB, count=41\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nbatch_generator(table) - size=0.0 KiB, count=0\nself.gen.throw(value) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_streaming_1757369979.vortex", "compress": false}
{"ts": 1757369979.587175, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming", "duration_ms": 18.47, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=255.8 KiB, count=2685\ntraces = _get_traces() - size=11.3 KiB, count=235\nFile \"<frozen abc>\", line 123 - size=4.9 KiB, count=74\nreturn (abs(self.size_diff), self.size, - size=16.1 KiB, count=207\nself._frames = tuple(reversed(frames)) - size=16.8 KiB, count=359", "rows": 100000}
{"ts": 1757369979.610184, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_io", "duration_ms": 1.081, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=3.8 KiB, count=73\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nbatch_generator(table) - size=0.0 KiB, count=0\ntraces = _get_traces() - size=19.2 KiB, count=404\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_streaming_1757369979.vortex", "compress": true}
{"ts": 1757369979.631814, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_compressed", "duration_ms": 24.429, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=28.7 KiB, count=606\nself._frames = tuple(reversed(frames)) - size=29.3 KiB, count=625\nreturn Array.from_arrow(obj) - size=3.7 KiB, count=71\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=2", "rows": 100000}
{"ts": 1757369979.684693, "label": "streaming_benchmark_fix_final_3", "block": "parquet.write", "duration_ms": 27.554, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_parquet_1757369979.parquet"}
{"ts": 1757369979.7116458, "label": "streaming_benchmark_fix_final_3", "block": "parquet.write.total", "duration_ms": 52.946, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=645.2 KiB, count=6923\ntraces = _get_traces() - size=37.4 KiB, count=791\nself._frames = tuple(reversed(frames)) - size=24.2 KiB, count=516\nreturn (abs(self.size_diff), self.size, - size=26.7 KiB, count=343\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7", "rows": 100000}
{"ts": 1757369979.797769, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.read_url", "duration_ms": 5.207, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nreturn Snapshot(traces, traceback_limit) - size=0.6 KiB, count=3\nself.traces = _Traces(traces) - size=0.6 KiB, count=3\ndef __exit__(self, typ, value, traceback): - size=0.5 KiB, count=7\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.1 KiB, count=1", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/vortex_read_test.vortex"}
{"ts": 1757369979.835892, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.to_arrow_table", "duration_ms": 3.504, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=16.2 KiB, count=345\ntraces = _get_traces() - size=50.0 KiB, count=1059\narray = self.to_arrow_array() - size=0.7 KiB, count=13\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757369979.836619, "label": "streaming_benchmark_fix_final_3", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0773}
{"ts": 1757369979.8877618, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.total", "duration_ms": 79.125, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=40.4 KiB, count=854\nself._frames = tuple(reversed(frames)) - size=27.2 KiB, count=580\nreturn (abs(self.size_diff), self.size, - size=28.1 KiB, count=360\narray = self.to_arrow_array() - size=0.6 KiB, count=11\nFile \"<frozen posixpath>\", line 385 - size=0.3 KiB, count=4", "rows": 100000}
{"ts": 1757369979.9585888, "label": "streaming_benchmark_fix_final_3", "block": "parquet.read", "duration_ms": 14.109, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6\ntable = self._dataset.to_table( - size=0.5 KiB, count=6\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.3 KiB, count=4\ndef read_table(source, *, columns=None, use_threads=True, - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/parquet_read_test.parquet"}
{"ts": 1757369979.994106, "label": "streaming_benchmark_fix_final_3", "block": "parquet.read.total", "duration_ms": 51.681, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=677.7 KiB, count=7284\ntraces = _get_traces() - size=46.6 KiB, count=987\nreturn (abs(self.size_diff), self.size, - size=31.3 KiB, count=402\nself._frames = tuple(reversed(frames)) - size=35.6 KiB, count=759\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6", "rows": 100000}
{"ts": 1757369979.995109, "label": "streaming_benchmark_fix_final_3", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.6208, "read_ratio": 0.6462, "size_ratio": 1.9323}
{"ts": 1757369982.7586439, "label": "streaming_benchmark_fix_final_3", "block": "data.generate", "duration_ms": 2727.37, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=8\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757369982.799069, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.default_reader", "duration_ms": 1.727, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=55.0 KiB, count=1167\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nprof.enable() - size=4.0 KiB, count=59"}
{"ts": 1757369983.027781, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.io", "duration_ms": 190.246, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=71.8 KiB, count=1525\nself._frames = tuple(reversed(frames)) - size=18.8 KiB, count=401\nvx.io.write(reader, file_path) - size=0.6 KiB, count=11\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_1757369982.vortex"}
{"ts": 1757369983.028654, "label": "streaming_benchmark_fix_final_3", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2674}
{"ts": 1757369983.0652218, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.total", "duration_ms": 269.327, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=55.1 KiB, count=1168\nlines = fp.readlines() - size=689.2 KiB, count=7409\nself._frames = tuple(reversed(frames)) - size=35.3 KiB, count=753\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nreturn (abs(self.size_diff), self.size, - size=32.0 KiB, count=410", "rows": 500000}
{"ts": 1757369983.1089191, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_io", "duration_ms": 2.085, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=5.4 KiB, count=104\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table) - size=0.0 KiB, count=0\nprof.enable() - size=4.1 KiB, count=61\nwith self.instr.profile_block(\"vortex.write.streaming_io\", {\"path\": file_path, \"compress\": compress}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_streaming_1757369983.vortex", "compress": false}
{"ts": 1757369983.1507368, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming", "duration_ms": 45.184, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=57.0 KiB, count=1209\nself._frames = tuple(reversed(frames)) - size=34.5 KiB, count=736\nreturn Array.from_arrow(obj) - size=5.3 KiB, count=103\nreturn compile(source, filename, mode, flags, - size=0.8 KiB, count=12\nwith self.instr.profile_block(\"vortex.write.streaming\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757369983.198796, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_io", "duration_ms": 2.229, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=6.5 KiB, count=124\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table) - size=0.0 KiB, count=0\nprof.enable() - size=4.1 KiB, count=62\nwith self.instr.profile_block(\"vortex.write.streaming_io\", {\"path\": file_path, \"compress\": compress}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_vortex_streaming_1757369983.vortex", "compress": true}
{"ts": 1757369983.24453, "label": "streaming_benchmark_fix_final_3", "block": "vortex.write.streaming_compressed", "duration_ms": 48.984, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=58.1 KiB, count=1233\nself._frames = tuple(reversed(frames)) - size=36.5 KiB, count=778\nreturn Array.from_arrow(obj) - size=6.4 KiB, count=123\nwith self.instr.profile_block(\"vortex.write.streaming_compressed\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.7 KiB, count=11", "rows": 500000}
{"ts": 1757369983.361633, "label": "streaming_benchmark_fix_final_3", "block": "parquet.write", "duration_ms": 71.81, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=4\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/test_parquet_1757369983.parquet"}
{"ts": 1757369983.405421, "label": "streaming_benchmark_fix_final_3", "block": "parquet.write.total", "duration_ms": 116.919, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=60.2 KiB, count=1277\nself._frames = tuple(reversed(frames)) - size=36.6 KiB, count=781\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=9\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.6 KiB, count=26", "rows": 500000}
{"ts": 1757369983.650128, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.read_url", "duration_ms": 4.503, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.5 KiB, count=4\nself.traces = _Traces(traces) - size=0.5 KiB, count=4\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=52.2 KiB, count=1105\nprof.enable() - size=4.3 KiB, count=65", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/vortex_read_test.vortex"}
{"ts": 1757369983.705937, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.to_arrow_table", "duration_ms": 9.659, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=18.8 KiB, count=402\ntraces = _get_traces() - size=79.6 KiB, count=1690\narray = self.to_arrow_array() - size=3.8 KiB, count=79\nreturn Array.from_arrow(obj) - size=6.0 KiB, count=114\nprof.enable() - size=4.1 KiB, count=63"}
{"ts": 1757369983.706851, "label": "streaming_benchmark_fix_final_3", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.1095}
{"ts": 1757369983.7513568, "label": "streaming_benchmark_fix_final_3", "block": "vortex.read.total", "duration_ms": 112.152, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.7 KiB, count=1329\nself._frames = tuple(reversed(frames)) - size=35.7 KiB, count=762\narray = self.to_arrow_array() - size=3.6 KiB, count=75\nreturn Array.from_arrow(obj) - size=6.0 KiB, count=114\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.7 KiB, count=11", "rows": 500000}
{"ts": 1757369983.876937, "label": "streaming_benchmark_fix_final_3", "block": "parquet.read", "duration_ms": 11.257, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\ntable = self._dataset.to_table( - size=0.5 KiB, count=7\nreturn Array.from_arrow(obj) - size=5.8 KiB, count=111\nreturn compile(source, filename, mode, flags, - size=0.6 KiB, count=10\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmphwr3ap8q/parquet_read_test.parquet"}
{"ts": 1757369983.922694, "label": "streaming_benchmark_fix_final_3", "block": "parquet.read.total", "duration_ms": 58.695, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=63.6 KiB, count=1348\nself._frames = tuple(reversed(frames)) - size=37.4 KiB, count=797\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=2.1 KiB, count=33\nwith self.instr.profile_block(\"parquet.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757369983.923914, "label": "streaming_benchmark_fix_final_3", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4293, "read_ratio": 0.5161, "size_ratio": 1.7877}
{"ts": 1757369983.9499671, "label": "streaming_benchmark_fix_final_3", "block": "format_comparison.quick", "duration_ms": 5036.433, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=901.3 KiB, count=9776\ntraces = _get_traces() - size=46.8 KiB, count=991\nself._frames = tuple(reversed(frames)) - size=42.8 KiB, count=914\ncallers[func] = nc, cc, tt, ct - size=39.8 KiB, count=238\nentries = self.getstats() - size=36.3 KiB, count=1425", "sizes": [100000, 500000]}
{"ts": 1757370189.026093, "label": "streaming_benchmark_final_fix", "block": "data.generate", "duration_ms": 559.507, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757370189.036543, "label": "streaming_benchmark_final_fix", "block": "vortex.write.default_reader", "duration_ms": 0.26, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757370189.097145, "label": "streaming_benchmark_final_fix", "block": "vortex.write.io", "duration_ms": 48.666, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_1757370189.vortex"}
{"ts": 1757370189.0976, "label": "streaming_benchmark_final_fix", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0701}
{"ts": 1757370189.108006, "label": "streaming_benchmark_final_fix", "block": "vortex.write.total", "duration_ms": 70.713, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=211.6 KiB, count=2171\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=216\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8", "rows": 100000}
{"ts": 1757370189.1251478, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_io", "duration_ms": 1.399, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=2.3 KiB, count=44\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nbatch_generator(table) - size=0.0 KiB, count=0\nself.gen.throw(value) - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_streaming_1757370189.vortex", "compress": false}
{"ts": 1757370189.1437812, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming", "duration_ms": 18.717, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=256.7 KiB, count=2695\ntraces = _get_traces() - size=11.0 KiB, count=229\nFile \"<frozen abc>\", line 123 - size=4.9 KiB, count=74\nreturn (abs(self.size_diff), self.size, - size=16.2 KiB, count=208\nreturn Array.from_arrow(obj) - size=2.1 KiB, count=41", "rows": 100000}
{"ts": 1757370189.166852, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_io", "duration_ms": 1.165, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=3.9 KiB, count=74\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=6\nbatch_generator(table) - size=0.0 KiB, count=0\ntraces = _get_traces() - size=19.0 KiB, count=400\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_streaming_1757370189.vortex", "compress": true}
{"ts": 1757370189.187865, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_compressed", "duration_ms": 24.068, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=28.5 KiB, count=601\nself._frames = tuple(reversed(frames)) - size=29.3 KiB, count=625\nreturn Array.from_arrow(obj) - size=3.7 KiB, count=71\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=2\nself.traces = _Traces(traces) - size=0.5 KiB, count=2", "rows": 100000}
{"ts": 1757370189.23986, "label": "streaming_benchmark_final_fix", "block": "parquet.write", "duration_ms": 25.933, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3\ndef __new__(cls, value): - size=0.2 KiB, count=3\ndef __call__(cls, value, names=_not_given, *values, module=None, qualname=None, type=None, start=1, boundary=None): - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_parquet_1757370189.parquet"}
{"ts": 1757370189.267102, "label": "streaming_benchmark_final_fix", "block": "parquet.write.total", "duration_ms": 52.061, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=646.2 KiB, count=6933\ntraces = _get_traces() - size=37.1 KiB, count=786\nself._frames = tuple(reversed(frames)) - size=23.5 KiB, count=501\nreturn (abs(self.size_diff), self.size, - size=26.8 KiB, count=344\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7", "rows": 100000}
{"ts": 1757370189.353972, "label": "streaming_benchmark_final_fix", "block": "vortex.read.read_url", "duration_ms": 4.519, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nself.traces = _Traces(traces) - size=0.6 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.6 KiB, count=3\ntraces = _get_traces() - size=32.8 KiB, count=694\ndef __exit__(self, typ, value, traceback): - size=0.5 KiB, count=7", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/vortex_read_test.vortex"}
{"ts": 1757370189.391934, "label": "streaming_benchmark_final_fix", "block": "vortex.read.to_arrow_table", "duration_ms": 3.313, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=16.3 KiB, count=347\ntraces = _get_traces() - size=49.9 KiB, count=1058\narray = self.to_arrow_array() - size=1.7 KiB, count=32\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757370189.392673, "label": "streaming_benchmark_final_fix", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.077}
{"ts": 1757370189.4435399, "label": "streaming_benchmark_final_fix", "block": "vortex.read.total", "duration_ms": 79.003, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=42.2 KiB, count=893\nself._frames = tuple(reversed(frames)) - size=25.0 KiB, count=533\narray = self.to_arrow_array() - size=1.6 KiB, count=30\nreturn (abs(self.size_diff), self.size, - size=28.1 KiB, count=360\nFile \"<frozen posixpath>\", line 385 - size=0.3 KiB, count=4", "rows": 100000}
{"ts": 1757370189.515595, "label": "streaming_benchmark_final_fix", "block": "parquet.read", "duration_ms": 12.891, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6\ntable = self._dataset.to_table( - size=0.5 KiB, count=6\ndef __getattr__(name): - size=0.3 KiB, count=5\nhasattr(path_or_paths, \"__fspath__\") and - size=0.2 KiB, count=3\ndef read_table(source, *, columns=None, use_threads=True, - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/parquet_read_test.parquet"}
{"ts": 1757370189.553451, "label": "streaming_benchmark_final_fix", "block": "parquet.read.total", "duration_ms": 53.249, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=678.6 KiB, count=7294\ntraces = _get_traces() - size=45.6 KiB, count=966\nreturn (abs(self.size_diff), self.size, - size=31.3 KiB, count=402\nself._frames = tuple(reversed(frames)) - size=35.6 KiB, count=759\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.6 KiB, count=6", "rows": 100000}
{"ts": 1757370189.554471, "label": "streaming_benchmark_final_fix", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.7283, "read_ratio": 0.6704, "size_ratio": 1.9323}
{"ts": 1757370192.373739, "label": "streaming_benchmark_final_fix", "block": "data.generate", "duration_ms": 2782.409, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=8\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757370192.4147048, "label": "streaming_benchmark_final_fix", "block": "vortex.write.default_reader", "duration_ms": 1.65, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=54.6 KiB, count=1159\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=2\nprof.enable() - size=3.9 KiB, count=58"}
{"ts": 1757370192.6445382, "label": "streaming_benchmark_final_fix", "block": "vortex.write.io", "duration_ms": 191.247, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=70.8 KiB, count=1504\nself._frames = tuple(reversed(frames)) - size=18.8 KiB, count=401\nvx.io.write(reader, file_path) - size=0.6 KiB, count=10\nprof.enable() - size=3.9 KiB, count=58\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_1757370192.vortex"}
{"ts": 1757370192.645441, "label": "streaming_benchmark_final_fix", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.2691}
{"ts": 1757370192.6827729, "label": "streaming_benchmark_final_fix", "block": "vortex.write.total", "duration_ms": 270.988, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=54.4 KiB, count=1154\nlines = fp.readlines() - size=690.1 KiB, count=7419\nself._frames = tuple(reversed(frames)) - size=34.9 KiB, count=744\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10\nreturn (abs(self.size_diff), self.size, - size=32.0 KiB, count=410", "rows": 500000}
{"ts": 1757370192.725013, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_io", "duration_ms": 2.04, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=5.7 KiB, count=109\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table) - size=0.0 KiB, count=0\nwith self.instr.profile_block(\"vortex.write.streaming_io\", {\"path\": file_path, \"compress\": compress}): - size=0.2 KiB, count=3\nprof.enable() - size=4.0 KiB, count=60", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_streaming_1757370192.vortex", "compress": false}
{"ts": 1757370192.766264, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming", "duration_ms": 43.334, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=56.2 KiB, count=1193\nself._frames = tuple(reversed(frames)) - size=35.1 KiB, count=748\nreturn Array.from_arrow(obj) - size=5.5 KiB, count=106\nreturn compile(source, filename, mode, flags, - size=0.8 KiB, count=13\nwith self.instr.profile_block(\"vortex.write.streaming\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757370192.816839, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_io", "duration_ms": 2.682, "cpu_profile": null, "mem_top": "return Array.from_arrow(obj) - size=6.9 KiB, count=133\nvx.io.write(array_iterator, file_path) - size=0.7 KiB, count=7\nbatch_generator(table) - size=0.0 KiB, count=0\nwith self.instr.profile_block(\"vortex.write.streaming_io\", {\"path\": file_path, \"compress\": compress}): - size=0.2 KiB, count=3\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_vortex_streaming_1757370192.vortex", "compress": true}
{"ts": 1757370192.865202, "label": "streaming_benchmark_final_fix", "block": "vortex.write.streaming_compressed", "duration_ms": 51.986, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=57.9 KiB, count=1227\nself._frames = tuple(reversed(frames)) - size=36.5 KiB, count=778\nreturn Array.from_arrow(obj) - size=6.7 KiB, count=130\nwith self.instr.profile_block(\"vortex.write.streaming_compressed\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nvortex_dtype = vx.DType.from_arrow(table.schema) - size=0.7 KiB, count=12", "rows": 500000}
{"ts": 1757370192.983701, "label": "streaming_benchmark_final_fix", "block": "parquet.write", "duration_ms": 71.592, "cpu_profile": null, "mem_top": "with ParquetWriter( - size=0.2 KiB, count=3\nwith self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nprof.enable() - size=4.3 KiB, count=66\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/test_parquet_1757370192.parquet"}
{"ts": 1757370193.028631, "label": "streaming_benchmark_final_fix", "block": "parquet.write.total", "duration_ms": 118.27, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=59.5 KiB, count=1262\nself._frames = tuple(reversed(frames)) - size=36.8 KiB, count=785\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nreturn os.stat(self, follow_symlinks=follow_symlinks) - size=0.3 KiB, count=9\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.5 KiB, count=24", "rows": 500000}
{"ts": 1757370193.26636, "label": "streaming_benchmark_final_fix", "block": "vortex.read.read_url", "duration_ms": 3.904, "cpu_profile": null, "mem_top": "self.traces = _Traces(traces) - size=0.5 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\nprof.enable() - size=4.5 KiB, count=69\nvortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=4", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/vortex_read_test.vortex"}
{"ts": 1757370193.3214898, "label": "streaming_benchmark_final_fix", "block": "vortex.read.to_arrow_table", "duration_ms": 9.228, "cpu_profile": null, "mem_top": "self._frames = tuple(reversed(frames)) - size=18.8 KiB, count=402\ntraces = _get_traces() - size=78.2 KiB, count=1660\narray = self.to_arrow_array() - size=4.8 KiB, count=100\nreturn Array.from_arrow(obj) - size=6.0 KiB, count=116\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=4"}
{"ts": 1757370193.3223958, "label": "streaming_benchmark_final_fix", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.1035}
{"ts": 1757370193.3673291, "label": "streaming_benchmark_final_fix", "block": "vortex.read.total", "duration_ms": 106.449, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=61.7 KiB, count=1309\nself._frames = tuple(reversed(frames)) - size=35.2 KiB, count=752\narray = self.to_arrow_array() - size=4.6 KiB, count=95\nreturn Array.from_arrow(obj) - size=6.0 KiB, count=116\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.6 KiB, count=10", "rows": 500000}
{"ts": 1757370193.495713, "label": "streaming_benchmark_final_fix", "block": "parquet.read", "duration_ms": 11.148, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\ntable = self._dataset.to_table( - size=0.5 KiB, count=7\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.4 KiB, count=22\ntraces = _get_traces() - size=51.5 KiB, count=1091\nreturn compile(source, filename, mode, flags, - size=0.7 KiB, count=11", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp4xh72s1f/parquet_read_test.parquet"}
{"ts": 1757370193.542763, "label": "streaming_benchmark_final_fix", "block": "parquet.read.total", "duration_ms": 62.915, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=62.4 KiB, count=1324\nself._frames = tuple(reversed(frames)) - size=37.5 KiB, count=800\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.9 KiB, count=9\nwith self.instr.profile_block(\"parquet.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.7 KiB, count=27", "rows": 500000}
{"ts": 1757370193.5440278, "label": "streaming_benchmark_final_fix", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.4307, "read_ratio": 0.5845, "size_ratio": 1.7877}
{"ts": 1757370193.5697129, "label": "streaming_benchmark_final_fix", "block": "format_comparison.quick", "duration_ms": 5081.162, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=902.3 KiB, count=9786\ntraces = _get_traces() - size=46.4 KiB, count=983\nself._frames = tuple(reversed(frames)) - size=42.4 KiB, count=904\ncallers[func] = nc, cc, tt, ct - size=39.8 KiB, count=238\nentries = self.getstats() - size=36.3 KiB, count=1425", "sizes": [100000, 500000]}
{"ts": 1757370320.774754, "label": "vortex_read_fix", "block": "data.generate", "duration_ms": 552.817, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=781.6 KiB, count=7\n'id': np.arange(num_rows, dtype=np.int64), - size=781.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=781.6 KiB, count=3\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=781.4 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=781.3 KiB, count=2", "rows": 100000, "complexity": "medium"}
{"ts": 1757370320.7850418, "label": "vortex_read_fix", "block": "vortex.write.default_reader", "duration_ms": 0.264, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=1.0 KiB, count=4\nself.traces = _Traces(traces) - size=1.0 KiB, count=4\nwith self.instr.profile_block(\"vortex.write.default_reader\"): - size=0.1 KiB, count=1\ntraces = _get_traces() - size=0.8 KiB, count=14\ndef __exit__(self, typ, value, traceback): - size=0.3 KiB, count=4"}
{"ts": 1757370320.843591, "label": "vortex_read_fix", "block": "vortex.write.io", "duration_ms": 46.861, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=8.4 KiB, count=174\nself._frames = tuple(reversed(frames)) - size=7.1 KiB, count=152\nvx.io.write(reader, file_path) - size=0.5 KiB, count=8\nreturn Snapshot(traces, traceback_limit) - size=0.9 KiB, count=3\nself.traces = _Traces(traces) - size=0.9 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_vortex_1757370320.vortex"}
{"ts": 1757370320.844079, "label": "vortex_read_fix", "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.068}
{"ts": 1757370320.853987, "label": "vortex_read_fix", "block": "vortex.write.total", "duration_ms": 68.59, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=212.3 KiB, count=2172\nself._frames = tuple(reversed(frames)) - size=10.1 KiB, count=216\nreturn (abs(self.size_diff), self.size, - size=13.0 KiB, count=167\ntraces = _get_traces() - size=8.5 KiB, count=177\nvx.io.write(reader, file_path) - size=0.4 KiB, count=7", "rows": 100000}
{"ts": 1757370320.890294, "label": "vortex_read_fix", "block": "parquet.write", "duration_ms": 20.353, "cpu_profile": null, "mem_top": "self.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\ndef _stringify_path(path): - size=0.3 KiB, count=4\nreturn Snapshot(traces, traceback_limit) - size=0.8 KiB, count=3\nself.traces = _Traces(traces) - size=0.8 KiB, count=3\nFile \"<frozen posixpath>\", line 229 - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_parquet_1757370320.parquet"}
{"ts": 1757370320.90689, "label": "vortex_read_fix", "block": "parquet.write.total", "duration_ms": 36.389, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=437.4 KiB, count=4610\ntraces = _get_traces() - size=9.7 KiB, count=202\nreturn (abs(self.size_diff), self.size, - size=15.6 KiB, count=201\nself.writer = _parquet.ParquetWriter( - size=1.6 KiB, count=7\nself._frames = tuple(reversed(frames)) - size=15.6 KiB, count=332", "rows": 100000}
{"ts": 1757370320.9328818, "label": "vortex_read_fix", "block": "vortex.read.read_url", "duration_ms": 2.431, "cpu_profile": null, "mem_top": "vortex_result = vx.io.read_url(file_url) - size=0.3 KiB, count=5\nreturn Snapshot(traces, traceback_limit) - size=0.7 KiB, count=3\nself.traces = _Traces(traces) - size=0.7 KiB, count=3\nprof.enable() - size=3.7 KiB, count=53\ntraces = _get_traces() - size=15.2 KiB, count=320", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_vortex_1757370320.vortex"}
{"ts": 1757370320.9575198, "label": "vortex_read_fix", "block": "vortex.read.to_arrow_table", "duration_ms": 2.427, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=21.3 KiB, count=448\nself._frames = tuple(reversed(frames)) - size=9.6 KiB, count=205\narray = self.to_arrow_array() - size=1.2 KiB, count=23\ndef _Array_to_arrow_table(self: _arrays.Array) -> pyarrow.Table: - size=0.2 KiB, count=3\ndef arrow_table_from_struct_array( - size=0.2 KiB, count=3"}
{"ts": 1757370320.958026, "label": "vortex_read_fix", "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0489}
{"ts": 1757370320.978913, "label": "vortex_read_fix", "block": "vortex.read.total", "duration_ms": 50.783, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=477.2 KiB, count=5063\ntraces = _get_traces() - size=16.4 KiB, count=343\nreturn (abs(self.size_diff), self.size, - size=17.0 KiB, count=218\narray = self.to_arrow_array() - size=1.1 KiB, count=22\nself._frames = tuple(reversed(frames)) - size=15.3 KiB, count=327", "rows": 100000}
{"ts": 1757370321.027241, "label": "vortex_read_fix", "block": "parquet.read", "duration_ms": 4.603, "cpu_profile": null, "mem_top": "parquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3\ndef __getattr__(name): - size=0.3 KiB, count=5\n\"module 'pyarrow.fs' has no attribute '{0}'\".format(name) - size=0.3 KiB, count=4\nhasattr(path_or_paths, \"__fspath__\") and - size=0.2 KiB, count=3\ndef read_table(source, *, columns=None, use_threads=True, - size=0.2 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/parquet_read_test.parquet"}
{"ts": 1757370321.051081, "label": "vortex_read_fix", "block": "parquet.read.total", "duration_ms": 29.572, "cpu_profile": null, "mem_top": "lines = fp.readlines() - size=509.6 KiB, count=5423\ntraces = _get_traces() - size=20.1 KiB, count=423\nreturn (abs(self.size_diff), self.size, - size=19.5 KiB, count=251\nself._frames = tuple(reversed(frames)) - size=17.9 KiB, count=381\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.4 KiB, count=3", "rows": 100000}
{"ts": 1757370321.0518131, "label": "vortex_read_fix", "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.5259, "read_ratio": 0.581, "size_ratio": 1.9323}
{"ts": 1757370323.851125, "label": "vortex_read_fix", "block": "data.generate", "duration_ms": 2774.799, "cpu_profile": null, "mem_top": "'price': (np.arange(num_rows) % 1000).astype(np.float64) + 0.99, - size=3906.6 KiB, count=7\n'value': np.arange(num_rows, dtype=np.float64) * 1.5, - size=3906.4 KiB, count=4\n'id': np.arange(num_rows, dtype=np.int64), - size=3906.6 KiB, count=6\n'score': np.arange(num_rows, dtype=np.float64) * 0.1, - size=3906.6 KiB, count=3\n'timestamp': np.arange(1000000, 1000000 + num_rows, dtype=np.int64), - size=3906.3 KiB, count=2", "rows": 500000, "complexity": "medium"}
{"ts": 1757370323.897034, "label": "vortex_read_fix", "block": "vortex.write.default_reader", "duration_ms": 19.915, "cpu_profile": null, "mem_top": "return (abs(self.size_diff), self.size, - size=0.3 KiB, count=4\nself._frames = tuple(reversed(frames)) - size=0.0 KiB, count=0\ntraces = _get_traces() - size=14.2 KiB, count=297\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.0 KiB, count=0\nreturn Snapshot(traces, traceback_limit) - size=0.6 KiB, count=4"}
{"ts": 1757370324.110591, "label": "vortex_read_fix", "block": "vortex.write.io", "duration_ms": 188.699, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=26.7 KiB, count=563\nself._frames = tuple(reversed(frames)) - size=11.3 KiB, count=242\nvx.io.write(reader, file_path) - size=0.6 KiB, count=11\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_vortex_1757370323.vortex"}
{"ts": 1757370324.1112251, "label": "vortex_read_fix", "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.258}
{"ts": 1757370324.1355479, "label": "vortex_read_fix", "block": "vortex.write.total", "duration_ms": 259.553, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=20.4 KiB, count=430\nself._frames = tuple(reversed(frames)) - size=19.3 KiB, count=411\nreturn (abs(self.size_diff), self.size, - size=20.6 KiB, count=265\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.1 KiB, count=16\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.0 KiB, count=0", "rows": 500000}
{"ts": 1757370324.230185, "label": "vortex_read_fix", "block": "parquet.write", "duration_ms": 68.523, "cpu_profile": null, "mem_top": "with self.instr.profile_block(\"parquet.write\", {\"path\": file_path}): - size=0.1 KiB, count=2\nwith ParquetWriter( - size=0.1 KiB, count=2\nraise TypeError(\"not a path-like object\") - size=0.1 KiB, count=2\nreturn Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_parquet_1757370324.parquet"}
{"ts": 1757370324.255295, "label": "vortex_read_fix", "block": "parquet.write.total", "duration_ms": 94.655, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=18.3 KiB, count=383\nself._frames = tuple(reversed(frames)) - size=21.6 KiB, count=461\nwith self.instr.profile_block(\"parquet.write.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=1.4 KiB, count=21\nmarkers = {} - size=0.0 KiB, count=0", "rows": 500000}
{"ts": 1757370324.286879, "label": "vortex_read_fix", "block": "vortex.read.read_url", "duration_ms": 3.198, "cpu_profile": null, "mem_top": "return Snapshot(traces, traceback_limit) - size=0.5 KiB, count=3\nself.traces = _Traces(traces) - size=0.5 KiB, count=3\nwith self.instr.profile_block(\"vortex.read.read_url\", {\"url\": file_url}): - size=0.2 KiB, count=4\ntraces = _get_traces() - size=21.9 KiB, count=460\nprof.enable() - size=4.2 KiB, count=65", "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/test_vortex_1757370323.vortex"}
{"ts": 1757370324.322034, "label": "vortex_read_fix", "block": "vortex.read.to_arrow_table", "duration_ms": 8.392, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=28.2 KiB, count=595\nself._frames = tuple(reversed(frames)) - size=11.9 KiB, count=254\narray = self.to_arrow_array() - size=2.1 KiB, count=42\nwith self.instr.profile_block(\"vortex.read.to_arrow_table\"): - size=0.1 KiB, count=1\nreturn pyarrow.Table.from_struct_array(array) - size=0.2 KiB, count=3"}
{"ts": 1757370324.322631, "label": "vortex_read_fix", "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0654}
{"ts": 1757370324.3481998, "label": "vortex_read_fix", "block": "vortex.read.total", "duration_ms": 67.08, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=21.2 KiB, count=445\nself._frames = tuple(reversed(frames)) - size=18.8 KiB, count=402\narray = self.to_arrow_array() - size=1.9 KiB, count=38\nwith open(self._json_path, \"a\", encoding=\"utf-8\") as f: - size=0.7 KiB, count=11\nwith self.instr.profile_block(\"vortex.read.total\", {\"rows\": num_rows}): - size=0.1 KiB, count=2", "rows": 500000}
{"ts": 1757370324.4528809, "label": "vortex_read_fix", "block": "parquet.read", "duration_ms": 10.221, "cpu_profile": null, "mem_top": "table = self._dataset.to_table( - size=0.5 KiB, count=7\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\ndataset = ParquetDataset( - size=0.1 KiB, count=1\nwith self.instr.profile_block(\"parquet.read\", {\"path\": file_path}): - size=0.1 KiB, count=2\nmarkers = {} - size=0.0 KiB, count=0", "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp548c85w0/parquet_read_test.parquet"}
{"ts": 1757370324.479258, "label": "vortex_read_fix", "block": "parquet.read.total", "duration_ms": 38.528, "cpu_profile": null, "mem_top": "traces = _get_traces() - size=23.3 KiB, count=489\nself._frames = tuple(reversed(frames)) - size=17.7 KiB, count=377\nparquet_format = ds.ParquetFileFormat(**read_options) - size=0.5 KiB, count=5\nreturn (abs(self.size_diff), self.size, - size=21.0 KiB, count=270\ntable = self._dataset.to_table( - size=0.3 KiB, count=3", "rows": 500000}
{"ts": 1757370324.480035, "label": "vortex_read_fix", "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3621, "read_ratio": 0.568, "size_ratio": 1.7877}
{"ts": 1757370324.496008, "label": "vortex_read_fix", "block": "format_comparison.quick", "duration_ms": 4261.642, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": "lines = fp.readlines() - size=544.7 KiB, count=5820\nself._frames = tuple(reversed(frames)) - size=24.9 KiB, count=531\ncallers[func] = nc, cc, tt, ct - size=24.4 KiB, count=153\nentries = self.getstats() - size=24.2 KiB, count=912\nself.stats[func] = cc, nc, tt, ct, callers - size=16.5 KiB, count=155", "sizes": [100000, 500000]}
{"ts": 1757372668.377792, "label": null, "block": "data.generate", "duration_ms": 27.072, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757372668.37822, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.067, "cpu_profile": null, "mem_top": null}
{"ts": 1757372668.4394581, "label": null, "block": "vortex.write.io", "duration_ms": 61.187, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_vortex_1757372668.vortex"}
{"ts": 1757372668.4396422, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0614}
{"ts": 1757372668.440075, "label": null, "block": "vortex.write.total", "duration_ms": 61.946, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372668.4678578, "label": null, "block": "parquet.write", "duration_ms": 27.664, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_parquet_1757372668.parquet"}
{"ts": 1757372668.468053, "label": null, "block": "parquet.write.total", "duration_ms": 27.877, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372668.473697, "label": null, "block": "vortex.read.read_url", "duration_ms": 5.484, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_vortex_1757372668.vortex"}
{"ts": 1757372668.475945, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 2.142, "cpu_profile": null, "mem_top": null}
{"ts": 1757372668.4760509, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0078}
{"ts": 1757372668.476347, "label": null, "block": "vortex.read.total", "duration_ms": 8.156, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372668.509821, "label": null, "block": "parquet.read", "duration_ms": 14.427, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/parquet_read_test.parquet"}
{"ts": 1757372668.5099819, "label": null, "block": "parquet.read.total", "duration_ms": 14.613, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372668.5100539, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.4526, "read_ratio": 1.8582, "size_ratio": 1.9323}
{"ts": 1757372668.626289, "label": null, "block": "data.generate", "duration_ms": 116.188, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757372668.626485, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.014, "cpu_profile": null, "mem_top": null}
{"ts": 1757372668.822013, "label": null, "block": "vortex.write.io", "duration_ms": 195.209, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_vortex_1757372668.vortex"}
{"ts": 1757372668.822203, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1957}
{"ts": 1757372668.822769, "label": null, "block": "vortex.write.total", "duration_ms": 196.314, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372668.892295, "label": null, "block": "parquet.write", "duration_ms": 69.418, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_parquet_1757372668.parquet"}
{"ts": 1757372668.892494, "label": null, "block": "parquet.write.total", "duration_ms": 69.633, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372668.894617, "label": null, "block": "vortex.read.read_url", "duration_ms": 1.953, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/test_vortex_1757372668.vortex"}
{"ts": 1757372668.901083, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 6.371, "cpu_profile": null, "mem_top": null}
{"ts": 1757372668.901255, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0086}
{"ts": 1757372668.901546, "label": null, "block": "vortex.read.total", "duration_ms": 8.899, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372668.97721, "label": null, "block": "parquet.read", "duration_ms": 9.178, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp0bd9ejo_/parquet_read_test.parquet"}
{"ts": 1757372668.977421, "label": null, "block": "parquet.read.total", "duration_ms": 9.414, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372668.977494, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3555, "read_ratio": 1.0898, "size_ratio": 1.7877}
{"ts": 1757372668.978475, "label": null, "block": "format_comparison.quick", "duration_ms": 627.464, "cpu_profile": "benchmark_results/format_comparison.quick.prof", "mem_top": null, "sizes": [100000, 500000]}
{"ts": 1757372677.1223402, "label": null, "block": "data.generate", "duration_ms": 24.267, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757372677.122494, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.012, "cpu_profile": null, "mem_top": null}
{"ts": 1757372677.1692832, "label": null, "block": "vortex.write.io", "duration_ms": 46.746, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_vortex_1757372677.vortex"}
{"ts": 1757372677.169499, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.047}
{"ts": 1757372677.169557, "label": null, "block": "vortex.write.total", "duration_ms": 47.079, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372677.189023, "label": null, "block": "parquet.write", "duration_ms": 19.416, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_parquet_1757372677.parquet"}
{"ts": 1757372677.189165, "label": null, "block": "parquet.write.total", "duration_ms": 19.562, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372677.190749, "label": null, "block": "vortex.read.read_url", "duration_ms": 1.38, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_vortex_1757372677.vortex"}
{"ts": 1757372677.191992, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 1.156, "cpu_profile": null, "mem_top": null}
{"ts": 1757372677.192051, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0027}
{"ts": 1757372677.192151, "label": null, "block": "vortex.read.total", "duration_ms": 2.789, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372677.214011, "label": null, "block": "parquet.read", "duration_ms": 3.457, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/parquet_read_test.parquet"}
{"ts": 1757372677.2141829, "label": null, "block": "parquet.read.total", "duration_ms": 3.634, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372677.2142348, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.4156, "read_ratio": 1.3477, "size_ratio": 1.9323}
{"ts": 1757372677.3309708, "label": null, "block": "data.generate", "duration_ms": 116.699, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757372677.331142, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.01, "cpu_profile": null, "mem_top": null}
{"ts": 1757372677.528255, "label": null, "block": "vortex.write.io", "duration_ms": 196.845, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_vortex_1757372677.vortex"}
{"ts": 1757372677.5284102, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1972}
{"ts": 1757372677.5284638, "label": null, "block": "vortex.write.total", "duration_ms": 197.339, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372677.599159, "label": null, "block": "parquet.write", "duration_ms": 70.248, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_parquet_1757372677.parquet"}
{"ts": 1757372677.599324, "label": null, "block": "parquet.write.total", "duration_ms": 70.417, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372677.6015658, "label": null, "block": "vortex.read.read_url", "duration_ms": 2.086, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/test_vortex_1757372677.vortex"}
{"ts": 1757372677.608028, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 6.367, "cpu_profile": null, "mem_top": null}
{"ts": 1757372677.608191, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0087}
{"ts": 1757372677.608524, "label": null, "block": "vortex.read.total", "duration_ms": 9.05, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372677.682996, "label": null, "block": "parquet.read", "duration_ms": 9.141, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpkj4dc7bs/parquet_read_test.parquet"}
{"ts": 1757372677.68324, "label": null, "block": "parquet.read.total", "duration_ms": 9.389, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372677.683296, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3568, "read_ratio": 1.074, "size_ratio": 1.7877}
{"ts": 1757372677.6838741, "label": null, "block": "format_comparison.quick", "duration_ms": 585.815, "cpu_profile": null, "mem_top": null, "sizes": [100000, 500000]}
{"ts": 1757372698.7680361, "label": null, "block": "data.generate", "duration_ms": 22.81, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757372698.768168, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 128000}
{"ts": 1757372698.768218, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.053, "cpu_profile": null, "mem_top": null}
{"ts": 1757372698.815156, "label": null, "block": "vortex.write.io", "duration_ms": 46.9, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_vortex_1757372698.vortex"}
{"ts": 1757372698.815349, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0471}
{"ts": 1757372698.815409, "label": null, "block": "vortex.write.total", "duration_ms": 47.248, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372698.8348138, "label": null, "block": "parquet.write", "duration_ms": 19.347, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_parquet_1757372698.parquet"}
{"ts": 1757372698.835043, "label": null, "block": "parquet.write.total", "duration_ms": 19.579, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372698.836888, "label": null, "block": "vortex.read.read_url", "duration_ms": 1.658, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_vortex_1757372698.vortex"}
{"ts": 1757372698.838249, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 1.178, "cpu_profile": null, "mem_top": null}
{"ts": 1757372698.8383229, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0031}
{"ts": 1757372698.838409, "label": null, "block": "vortex.read.total", "duration_ms": 3.195, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372698.860529, "label": null, "block": "parquet.read", "duration_ms": 3.497, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/parquet_read_test.parquet"}
{"ts": 1757372698.8607202, "label": null, "block": "parquet.read.total", "duration_ms": 3.693, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372698.860779, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.4148, "read_ratio": 1.1871, "size_ratio": 1.9323}
{"ts": 1757372698.97437, "label": null, "block": "data.generate", "duration_ms": 113.551, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757372698.974567, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 128000}
{"ts": 1757372698.974934, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.371, "cpu_profile": null, "mem_top": null}
{"ts": 1757372699.169718, "label": null, "block": "vortex.write.io", "duration_ms": 194.746, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_vortex_1757372698.vortex"}
{"ts": 1757372699.169987, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1954}
{"ts": 1757372699.17038, "label": null, "block": "vortex.write.total", "duration_ms": 195.823, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372699.2429771, "label": null, "block": "parquet.write", "duration_ms": 72.522, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_parquet_1757372699.parquet"}
{"ts": 1757372699.2431512, "label": null, "block": "parquet.write.total", "duration_ms": 72.703, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372699.245503, "label": null, "block": "vortex.read.read_url", "duration_ms": 2.183, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/test_vortex_1757372698.vortex"}
{"ts": 1757372699.252654, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 7.003, "cpu_profile": null, "mem_top": null}
{"ts": 1757372699.25284, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0095}
{"ts": 1757372699.2533271, "label": null, "block": "vortex.read.total", "duration_ms": 10.016, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372699.3303192, "label": null, "block": "parquet.read", "duration_ms": 9.283, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp6kfu3j_f/parquet_read_test.parquet"}
{"ts": 1757372699.330515, "label": null, "block": "parquet.read.total", "duration_ms": 9.484, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372699.3305678, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3719, "read_ratio": 0.9931, "size_ratio": 1.7877}
{"ts": 1757372699.3310761, "label": null, "block": "format_comparison.quick", "duration_ms": 585.867, "cpu_profile": null, "mem_top": null, "sizes": [100000, 500000]}
{"ts": 1757372699.961496, "label": null, "block": "data.generate", "duration_ms": 23.218, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757372699.961635, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 256000}
{"ts": 1757372699.961695, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.063, "cpu_profile": null, "mem_top": null}
{"ts": 1757372700.0085142, "label": null, "block": "vortex.write.io", "duration_ms": 46.779, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_vortex_1757372699.vortex"}
{"ts": 1757372700.008694, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.047}
{"ts": 1757372700.008745, "label": null, "block": "vortex.write.total", "duration_ms": 47.118, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372700.028634, "label": null, "block": "parquet.write", "duration_ms": 19.834, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_parquet_1757372700.parquet"}
{"ts": 1757372700.028768, "label": null, "block": "parquet.write.total", "duration_ms": 19.972, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372700.030447, "label": null, "block": "vortex.read.read_url", "duration_ms": 1.44, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_vortex_1757372699.vortex"}
{"ts": 1757372700.0318038, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 1.273, "cpu_profile": null, "mem_top": null}
{"ts": 1757372700.031879, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0029}
{"ts": 1757372700.0319722, "label": null, "block": "vortex.read.total", "duration_ms": 2.972, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372700.053913, "label": null, "block": "parquet.read", "duration_ms": 3.412, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/parquet_read_test.parquet"}
{"ts": 1757372700.0541341, "label": null, "block": "parquet.read.total", "duration_ms": 3.641, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372700.054206, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.4241, "read_ratio": 1.259, "size_ratio": 1.9323}
{"ts": 1757372700.174648, "label": null, "block": "data.generate", "duration_ms": 120.395, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757372700.174857, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 256000}
{"ts": 1757372700.1752179, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.364, "cpu_profile": null, "mem_top": null}
{"ts": 1757372700.368754, "label": null, "block": "vortex.write.io", "duration_ms": 193.497, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_vortex_1757372700.vortex"}
{"ts": 1757372700.368978, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1941}
{"ts": 1757372700.3694248, "label": null, "block": "vortex.write.total", "duration_ms": 194.578, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372700.439659, "label": null, "block": "parquet.write", "duration_ms": 69.962, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_parquet_1757372700.parquet"}
{"ts": 1757372700.4398239, "label": null, "block": "parquet.write.total", "duration_ms": 70.132, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372700.4420102, "label": null, "block": "vortex.read.read_url", "duration_ms": 2.016, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/test_vortex_1757372700.vortex"}
{"ts": 1757372700.448718, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 6.656, "cpu_profile": null, "mem_top": null}
{"ts": 1757372700.4488451, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0089}
{"ts": 1757372700.4492018, "label": null, "block": "vortex.read.total", "duration_ms": 9.214, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372700.524197, "label": null, "block": "parquet.read", "duration_ms": 9.006, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpuo46xggf/parquet_read_test.parquet"}
{"ts": 1757372700.524461, "label": null, "block": "parquet.read.total", "duration_ms": 9.275, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372700.5245178, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3611, "read_ratio": 1.0441, "size_ratio": 1.7877}
{"ts": 1757372700.525193, "label": null, "block": "format_comparison.quick", "duration_ms": 586.929, "cpu_profile": null, "mem_top": null, "sizes": [100000, 500000]}
{"ts": 1757372701.09269, "label": null, "block": "data.generate", "duration_ms": 23.356, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757372701.092799, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 512000}
{"ts": 1757372701.092848, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.052, "cpu_profile": null, "mem_top": null}
{"ts": 1757372701.1389592, "label": null, "block": "vortex.write.io", "duration_ms": 46.072, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_vortex_1757372701.vortex"}
{"ts": 1757372701.1391082, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0463}
{"ts": 1757372701.1391628, "label": null, "block": "vortex.write.total", "duration_ms": 46.371, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372701.1581628, "label": null, "block": "parquet.write", "duration_ms": 18.948, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_parquet_1757372701.parquet"}
{"ts": 1757372701.158287, "label": null, "block": "parquet.write.total", "duration_ms": 19.075, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372701.159921, "label": null, "block": "vortex.read.read_url", "duration_ms": 1.414, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_vortex_1757372701.vortex"}
{"ts": 1757372701.161189, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 1.197, "cpu_profile": null, "mem_top": null}
{"ts": 1757372701.161262, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0028}
{"ts": 1757372701.161379, "label": null, "block": "vortex.read.total", "duration_ms": 2.879, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372701.1827688, "label": null, "block": "parquet.read", "duration_ms": 3.251, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/parquet_read_test.parquet"}
{"ts": 1757372701.1828768, "label": null, "block": "parquet.read.total", "duration_ms": 3.363, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757372701.182921, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.4115, "read_ratio": 1.2117, "size_ratio": 1.9323}
{"ts": 1757372701.297903, "label": null, "block": "data.generate", "duration_ms": 114.946, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757372701.298115, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 512000}
{"ts": 1757372701.298434, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.323, "cpu_profile": null, "mem_top": null}
{"ts": 1757372701.4878762, "label": null, "block": "vortex.write.io", "duration_ms": 189.387, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_vortex_1757372701.vortex"}
{"ts": 1757372701.4880471, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1899}
{"ts": 1757372701.488093, "label": null, "block": "vortex.write.total", "duration_ms": 189.989, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372701.55698, "label": null, "block": "parquet.write", "duration_ms": 68.314, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_parquet_1757372701.parquet"}
{"ts": 1757372701.557157, "label": null, "block": "parquet.write.total", "duration_ms": 68.495, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372701.559445, "label": null, "block": "vortex.read.read_url", "duration_ms": 2.138, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/test_vortex_1757372701.vortex"}
{"ts": 1757372701.56652, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 6.967, "cpu_profile": null, "mem_top": null}
{"ts": 1757372701.56668, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0094}
{"ts": 1757372701.567022, "label": null, "block": "vortex.read.total", "duration_ms": 9.721, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372701.6421702, "label": null, "block": "parquet.read", "duration_ms": 9.481, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmpk4uv98cg/parquet_read_test.parquet"}
{"ts": 1757372701.642418, "label": null, "block": "parquet.read.total", "duration_ms": 9.732, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757372701.642476, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3605, "read_ratio": 1.0352, "size_ratio": 1.7877}
{"ts": 1757372701.643177, "label": null, "block": "format_comparison.quick", "duration_ms": 573.857, "cpu_profile": null, "mem_top": null, "sizes": [100000, 500000]}
{"ts": 1757376255.918408, "label": null, "block": "data.generate", "duration_ms": 24.688, "cpu_profile": null, "mem_top": null, "rows": 100000, "complexity": "medium"}
{"ts": 1757376255.918758, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 512000}
{"ts": 1757376255.9188428, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.088, "cpu_profile": null, "mem_top": null}
{"ts": 1757376255.966939, "label": null, "block": "vortex.write.io", "duration_ms": 48.056, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_vortex_1757376255.vortex"}
{"ts": 1757376255.9671092, "label": null, "event": "vortex.write.complete", "bytes": 1624732, "seconds": 0.0483}
{"ts": 1757376255.9673522, "label": null, "block": "vortex.write.total", "duration_ms": 48.602, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757376255.993591, "label": null, "block": "parquet.write", "duration_ms": 26.191, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_parquet_1757376255.parquet"}
{"ts": 1757376255.993727, "label": null, "block": "parquet.write.total", "duration_ms": 26.33, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757376256.002065, "label": null, "block": "vortex.read.read_url", "duration_ms": 8.125, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_vortex_1757376255.vortex"}
{"ts": 1757376256.004051, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 1.859, "cpu_profile": null, "mem_top": null}
{"ts": 1757376256.0041301, "label": null, "event": "vortex.read.complete", "rows": 100000, "seconds": 0.0102}
{"ts": 1757376256.004437, "label": null, "block": "vortex.read.total", "duration_ms": 10.503, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757376256.03484, "label": null, "block": "parquet.read", "duration_ms": 11.242, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/parquet_read_test.parquet"}
{"ts": 1757376256.03498, "label": null, "block": "parquet.read.total", "duration_ms": 11.391, "cpu_profile": null, "mem_top": null, "rows": 100000}
{"ts": 1757376256.035025, "label": null, "event": "comparison.metrics", "rows": 100000, "write_ratio": 0.5443, "read_ratio": 1.116, "size_ratio": 1.9323}
{"ts": 1757376256.153962, "label": null, "block": "data.generate", "duration_ms": 118.899, "cpu_profile": null, "mem_top": null, "rows": 500000, "complexity": "medium"}
{"ts": 1757376256.15418, "label": null, "event": "vortex.write.batch_size", "small_batch_size": 512000}
{"ts": 1757376256.154482, "label": null, "block": "vortex.write.default_reader", "duration_ms": 0.307, "cpu_profile": null, "mem_top": null}
{"ts": 1757376256.3425322, "label": null, "block": "vortex.write.io", "duration_ms": 188.001, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_vortex_1757376256.vortex"}
{"ts": 1757376256.342732, "label": null, "event": "vortex.write.complete", "bytes": 6619724, "seconds": 0.1885}
{"ts": 1757376256.3431659, "label": null, "block": "vortex.write.total", "duration_ms": 188.996, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757376256.416163, "label": null, "block": "parquet.write", "duration_ms": 72.931, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_parquet_1757376256.parquet"}
{"ts": 1757376256.41636, "label": null, "block": "parquet.write.total", "duration_ms": 73.132, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757376256.41858, "label": null, "block": "vortex.read.read_url", "duration_ms": 2.084, "cpu_profile": null, "mem_top": null, "url": "file:///var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/test_vortex_1757376256.vortex"}
{"ts": 1757376256.425684, "label": null, "block": "vortex.read.to_arrow_table", "duration_ms": 6.988, "cpu_profile": null, "mem_top": null}
{"ts": 1757376256.425825, "label": null, "event": "vortex.read.complete", "rows": 500000, "seconds": 0.0093}
{"ts": 1757376256.426162, "label": null, "block": "vortex.read.total", "duration_ms": 9.677, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757376256.500424, "label": null, "block": "parquet.read", "duration_ms": 9.008, "cpu_profile": null, "mem_top": null, "path": "/var/folders/_5/8smr8tkj0gv9jf7rs92fcwfr0000gn/T/tmp2s9lgleh/parquet_read_test.parquet"}
{"ts": 1757376256.500648, "label": null, "block": "parquet.read.total", "duration_ms": 9.235, "cpu_profile": null, "mem_top": null, "rows": 500000}
{"ts": 1757376256.500709, "label": null, "event": "comparison.metrics", "rows": 500000, "write_ratio": 0.3877, "read_ratio": 0.9856, "size_ratio": 1.7877}
{"ts": 1757376256.5012841, "label": null, "block": "format_comparison.quick", "duration_ms": 607.572, "cpu_profile": null, "mem_top": null, "sizes": [100000, 500000]}
